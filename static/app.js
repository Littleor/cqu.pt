webpackJsonp([4],[function(e,t,s){e.exports=s(16)},function(e,t,s){!function(s){function a(e,t){t=t||{},this._id=a._generateUUID(),this._promise=t.promise||Promise,this._frameId=t.frameId||"CrossStorageClient-"+this._id,this._origin=a._getOrigin(e),this._requests={},this._connected=!1,this._closed=!1,this._count=0,this._timeout=t.timeout||5e3,this._listener=null,this._installListener();var s;t.frameId&&(s=document.getElementById(t.frameId)),s&&this._poll(),s=s||this._createFrame(e),this._hub=s.contentWindow}a.frameStyle={display:"none",position:"absolute",top:"-999px",left:"-999px"},a._getOrigin=function(e){var t,s,a;return t=document.createElement("a"),t.href=e,t.host||(t=window.location),s=t.protocol&&":"!==t.protocol?t.protocol:window.location.protocol,a=s+"//"+t.host,a=a.replace(/:80$|:443$/,"")},a._generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,s="x"==e?t:3&t|8;return s.toString(16)})},a.prototype.onConnect=function(){var e=this;return this._connected?this._promise.resolve():this._closed?this._promise.reject(new Error("CrossStorageClient has closed")):(this._requests.connect||(this._requests.connect=[]),new this._promise(function(t,s){var a=setTimeout(function(){s(new Error("CrossStorageClient could not connect"))},e._timeout);e._requests.connect.push(function(e){return clearTimeout(a),e?s(e):void t()})}))},a.prototype.set=function(e,t){return this._request("set",{key:e,value:t})},a.prototype.get=function(e){var t=Array.prototype.slice.call(arguments);return this._request("get",{keys:t})},a.prototype.del=function(){var e=Array.prototype.slice.call(arguments);return this._request("del",{keys:e})},a.prototype.clear=function(){return this._request("clear")},a.prototype.getKeys=function(){return this._request("getKeys")},a.prototype.close=function(){var e=document.getElementById(this._frameId);e&&e.parentNode.removeChild(e),window.removeEventListener?window.removeEventListener("message",this._listener,!1):window.detachEvent("onmessage",this._listener),this._connected=!1,this._closed=!0},a.prototype._installListener=function(){var e=this;this._listener=function(t){var s,a,n,i;if(!e._closed&&t.data&&"string"==typeof t.data&&(a="null"===t.origin?"file://":t.origin,a===e._origin))if("cross-storage:unavailable"!==t.data){if(t.data.indexOf("cross-storage:")!==-1&&!e._connected){if(e._connected=!0,!e._requests.connect)return;for(s=0;s<e._requests.connect.length;s++)e._requests.connect[s](n);delete e._requests.connect}if("cross-storage:ready"!==t.data){try{i=JSON.parse(t.data)}catch(r){return}i.id&&e._requests[i.id]&&e._requests[i.id](i.error,i.result)}}else{if(e._closed||e.close(),!e._requests.connect)return;for(n=new Error("Closing client. Could not access localStorage in hub."),s=0;s<e._requests.connect.length;s++)e._requests.connect[s](n)}},window.addEventListener?window.addEventListener("message",this._listener,!1):window.attachEvent("onmessage",this._listener)},a.prototype._poll=function(){var e,t,s;e=this,s="file://"===e._origin?"*":e._origin,t=setInterval(function(){return e._connected?clearInterval(t):void(e._hub&&e._hub.postMessage("cross-storage:poll",s))},1e3)},a.prototype._createFrame=function(e){var t,s;t=window.document.createElement("iframe"),t.id=this._frameId;for(s in a.frameStyle)a.frameStyle.hasOwnProperty(s)&&(t.style[s]=a.frameStyle[s]);return window.document.body.appendChild(t),t.src=e,t},a.prototype._request=function(e,t){var s,a;return this._closed?this._promise.reject(new Error("CrossStorageClient has closed")):(a=this,a._count++,s={id:this._id+":"+a._count,method:"cross-storage:"+e,params:t},new this._promise(function(e,t){var n,i,r;n=setTimeout(function(){a._requests[s.id]&&(delete a._requests[s.id],t(new Error("Timeout: could not perform "+s.method)))},a._timeout),a._requests[s.id]=function(i,r){return clearTimeout(n),delete a._requests[s.id],i?t(new Error(i)):void e(r)},Array.prototype.toJSON&&(i=Array.prototype.toJSON,Array.prototype.toJSON=null),r="file://"===a._origin?"*":a._origin,a._hub.postMessage(JSON.stringify(s),r),i&&(Array.prototype.toJSON=i)}))},"undefined"!=typeof e&&e.exports?e.exports=a:t.CrossStorageClient=a}(this)},function(e,t,s){!function(s){var a={};a.init=function(e){var t=!0;try{window.localStorage||(t=!1)}catch(s){t=!1}if(!t)try{return window.parent.postMessage("cross-storage:unavailable","*")}catch(s){return}a._permissions=e||[],a._installListener(),window.parent.postMessage("cross-storage:ready","*")},a._installListener=function(){var e=a._listener;window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent("onmessage",e)},a._listener=function(e){var t,s,n,i,r,o,d;if(t="null"===e.origin?"file://":e.origin,"cross-storage:poll"===e.data)return window.parent.postMessage("cross-storage:ready",e.origin);if("cross-storage:ready"!==e.data){try{n=JSON.parse(e.data)}catch(c){return}if(n&&"string"==typeof n.method&&(i=n.method.split("cross-storage:")[1])){if(a._permitted(t,i))try{o=a["_"+i](n.params)}catch(c){r=c.message}else r="Invalid permissions for "+i;d=JSON.stringify({id:n.id,error:r,result:o}),s="file://"===t?"*":t,window.parent.postMessage(d,s)}}},a._permitted=function(e,t){var s,n,i,r;if(s=["get","set","del","clear","getKeys"],!a._inArray(t,s))return!1;for(n=0;n<a._permissions.length;n++)if(i=a._permissions[n],i.origin instanceof RegExp&&i.allow instanceof Array&&(r=i.origin.test(e),r&&a._inArray(t,i.allow)))return!0;return!1},a._set=function(e){window.localStorage.setItem(e.key,e.value)},a._get=function(e){var t,s,a,n;for(t=window.localStorage,s=[],a=0;a<e.keys.length;a++){try{n=t.getItem(e.keys[a])}catch(i){n=null}s.push(n)}return s.length>1?s:s[0]},a._del=function(e){for(var t=0;t<e.keys.length;t++)window.localStorage.removeItem(e.keys[t])},a._clear=function(){window.localStorage.clear()},a._getKeys=function(e){var t,s,a;for(a=[],s=window.localStorage.length,t=0;t<s;t++)a.push(window.localStorage.key(t));return a},a._inArray=function(e,t){for(var s=0;s<t.length;s++)if(e===t[s])return!0;return!1},a._now=function(){return"function"==typeof Date.now?Date.now():(new Date).getTime()},"undefined"!=typeof e&&e.exports?e.exports=a:t.CrossStorageHub=a}(this)},function(e,t,s){e.exports={CrossStorageClient:s(1),CrossStorageHub:s(2)}},function(e,t,s){e.exports='<!--[if IE]><p class="kill-ie">微软都放弃了IE，为啥你却还不放弃？</p><![endif]--> <div id=_cqupt-side-box> <div class=_cqupt-side-bar> <div class=_cqupt-side-bar-item id=_cqupt-title> <a href=javascript:void(0);><i>×</i> 内网外入</a> <span class=_cqupt-side-bar-tip>隐藏</span> </div> <div class=_cqupt-side-bar-top> <a href=//cqupt.congm.in class=_cqupt-side-bar-item> <span class=_cqupt-iconfont>&#xe601;</span> <span class=_cqupt-side-bar-tip>主页</span> </a> <div class=_cqupt-side-bar-item data-toggle=sideTab data-target=#_cqupt-user-info> <span class=_cqupt-iconfont>&#xe602;</span> <span class=_cqupt-side-bar-tip>导航</span> </div> <a href=https://we.cqu.pt target=_blank class=_cqupt-side-bar-item> <img class=_cqupt-side-bar-img src=//cqupt.congm.in/src/img/wecqupt.png> <span class=_cqupt-side-bar-tip>We重邮</span> </a> </div> <div class=_cqupt-side-bar-bottom> <div class=_cqupt-side-bar-item data-toggle=sideTab data-target=#_cqupt-duosuo> <span class=_cqupt-iconfont>&#xe600;</span> <span class=_cqupt-side-bar-tip>评论</span> </div> <div class=_cqupt-side-bar-item data-toggle=sideTab data-target=#_cqupt-donate> <span class=_cqupt-iconfont>&#xe603;</span> <span class=_cqupt-side-bar-tip>捐助</span> </div> <div class=_cqupt-side-bar-item data-toggle=sideTab data-target=#_cqupt-info> <span class=_cqupt-iconfont>&#xe604;</span> <span class=_cqupt-side-bar-tip>关于</span> </div> <a href="http://jq.qq.com/?_wv=1027&k=2EgWhWy" target=_blank class=_cqupt-side-bar-item> <span class=_cqupt-iconfont>&#xe605;</span> <span class=_cqupt-side-bar-tip>内网外入交流群：312784909</span> </a> </div> </div> <header class=_cqupt-header> <div id=_cqupt-header-close data-toggle=sideTab data-target=close><img src='+s(6)+'></div> </header> <div class=_cqupt-content> <div class="_cqupt-content-item _cqupt-hidden" id=_cqupt-user-info> <div class=_cqupt-content-hd>导航</div> <div class=_cqupt-content-bd> <div class=_cqupt-nav-info> <small class=_cqupt-small>【<span class=_cqupt-nav-user-name></span>】同学，你好！这是你的专属链接：</small> <div class=_cqupt-nav-list> <a class="_cqupt-nav-item _cqupt-nav-user-info-btn" href=javascript:void(0); target=_blank>你的信息</a> <a class="_cqupt-nav-item _cqupt-nav-user-pic-btn" href=javascript:void(0); target=_blank>你的照片</a> <a class="_cqupt-nav-item _cqupt-nav-user-kb-btn" href=javascript:void(0); target=_blank>你的课表</a> </div> <div class=_cqupt-nav-info-cont> <div class="_cqupt-nav-user-info _cqupt-hidden"> <table> <tbody> <tr><td><span class=_cqupt-nav-user-xm></span> (<span class=_cqupt-nav-user-xb></span>)</td><td><span class=_cqupt-nav-user-xh></span></td></tr> <tr><td><span class=_cqupt-nav-user-yxm></span></td><td><span class=_cqupt-nav-user-nj></span></td></tr> <tr><td><span class=_cqupt-nav-user-zym></span></td><td><span class=_cqupt-nav-user-bj></span></td></tr> </tbody> </table> </div> <div class="_cqupt-nav-user-pic _cqupt-hidden"> </div> </div> </div> <small class=_cqupt-small>热门排行</small> <div class=_cqupt-nav-list> <a class=_cqupt-nav-item-o href=https://jwzx.cqupt.congm.in target=_blank>教务在线</a> <a class=_cqupt-nav-item-o href=http://xk1.cqupt.edu.cn.cqupt.congm.in target=_blank>选课地址1</a> <a class=_cqupt-nav-item-o href=http://xk2.cqupt.edu.cn.cqupt.congm.in/ target=_blank>选课地址2</a> <a class=_cqupt-nav-item-o href=http://222.177.140.105.cqupt.congm.in target=_blank>网上党校</a> <a class=_cqupt-nav-item-o href=http://202.202.43.222/bysj/ target=_blank>毕业设计</a> <a class=_cqupt-nav-item-o href=http://xk4.cqupt.edu.cn.cqupt.congm.in target=_blank>选课地址4</a> <a class=_cqupt-nav-item-o href=http://xk2.cqupt.edu.cn.cqupt.congm.in/xpj2016/ target=_blank>学评教</a> <a class=_cqupt-nav-item-o href=http://oa.cqupt.edu.cn.cqupt.congm.in target=_blank>校务信息网</a> <a class=_cqupt-nav-item-o href=http://oj.cqupt.edu.cn.cqupt.congm.in target=_blank>ACM/OJ</a> <a class=_cqupt-nav-item-o href=http://job.cqupt.edu.cn target=_blank>就业信息网</a> <a class=_cqupt-nav-item-o href=http://bbs.cqupt.edu.cn target=_blank>幽幽黄桷兰</a> <a class=_cqupt-nav-item-o href=http://gs.cqupt.edu.cn target=_blank>研究生学院</a> <a class=_cqupt-nav-item-o href=http://172.20.200.60.cqupt.congm.in target=_blank>教学资源库</a> <a class=_cqupt-nav-item-o href=http://cyhq.cqupt.edu.cn.cqupt.congm.in target=_blank>后勤服务</a> <a class=_cqupt-nav-item-o href=http://hongyan.cqupt.edu.cn target=_blank>红岩网校</a> <a class=_cqupt-nav-item-o href=http://www.cqupt.edu.cn target=_blank>重邮主页</a> <a class=_cqupt-nav-item-o href=http://tsg.cqupt.edu.cn target=_blank>图书馆</a> <a class=_cqupt-nav-item-o href=http://zs.cqupt.edu.cn.cqupt.congm.in target=_blank>招生信息网</a> </div> <div class=_cqupt-nav-more> <small class=_cqupt-small>截至2016年12月24日，内网外入总访问量已突破两百万，该列表为各站访问量排行。</small> </div> </div> </div> <div class="_cqupt-content-item _cqupt-hidden" id=_cqupt-duosuo> <div class=_cqupt-content-hd>评论</div> <div class=_cqupt-content-bd> <div class="ds-share flat" data-thread-key=1 data-title="内网外入 - CQUPT" data-content=一站解决外网访问教务在线等内网所有网页！ data-url=https://cqupt.congm.in> <div class=ds-share-inline> <ul class=ds-share-icons-16> <li data-toggle=ds-share-icons-more><a class=ds-more href=javascript:void(0);>分享:</a></li> <li><a class=ds-weibo href=javascript:void(0); data-service=weibo>微博</a></li> <li><a class=ds-wechat href=javascript:void(0); data-service=wechat>微信</a></li> <li><a class=ds-qq href=javascript:void(0); data-service=qq>QQ</a></li> <li><a class=ds-qzone href=javascript:void(0); data-service=qzone>空间</a></li> </ul> <div class=ds-share-icons-more></div> </div> </div> <span class=_cqupt-loading>正在加载中...</span> </div> </div> <div class="_cqupt-content-item _cqupt-hidden" id=_cqupt-donate> <div class=_cqupt-content-hd>捐助</div> <div class=_cqupt-content-bd> <h3><span class="_cqupt-label _cqupt-label-o">内网外入</span> (cqupt.congm.in) 是一个免费的系统，但是内网外入服务器搭建于我的旧电脑之上，每月需要宽带网络和运营维护的成本。</h3> <p>如果您觉得内网外入极大方便您的日常使用，您可以自愿选择通过捐赠来促进内网外入的健康维护和发展，内网外入也需要大家的点滴支持。</p> <p class=_cqupt-small>支付宝帐号：i@congm.in / 这是昵称 (闵聪)</p> <img src=//cqupt.congm.in/src/img/alipay.png class=_cqupt-donate-img> <h2>捐助人列表 <small class=_cqupt-small>(每日更新)</small></h2> <table class=_cqupt-donate-list> <thead> <tr> <th>账户</th><th>用户名</th><th>时间</th><th>金额</th> </tr> </thead> </table> </div> </div> <div class="_cqupt-content-item _cqupt-hidden" id=_cqupt-info> <div class=_cqupt-content-hd>关于</div> <div class=_cqupt-content-bd> <h2>内网外入 (cqupt.congm.in) </h2> <h3><span class="_cqupt-label _cqupt-label-sm">重庆邮电大学</span> <span class="_cqupt-label _cqupt-label-sm">个人出品</span> <span class="_cqupt-label _cqupt-label-sm">非官方出品</span></h3> <p>内网外入诞生于2015年9月，该系统利用nginx服务器反向代理的原理，方便了重邮同学通过外网直接访问内网。该系统在保证内网安全的前提下，可以随时随地进入内网查询自己的个人课表、考试安排、期末成绩，进行选课等，极大方便同学们的日常使用。网页上线16个月来，总访问量(PV)超过200万多次，PV单日峰值达5万多次，独立访客(UV)日均约1200人，UV日峰值超1万人。</p> <div class=_cqupt-info-list> <p>官网：<a href=//cqupt.congm.in target=_blank>cqupt.congm.in</a></p> <p>Github：<a href=https://github.com/mcc108/cqupt.congm.in target=_blank>github.com/mcc108/cqupt.congm.in</a></p> <p>交流群：<a href="http://jq.qq.com/?_wv=1027&k=2EgWhWy" target=_blank>312784909</a></p> <p>博文：<a href=//i.congm.in/cqupt-inner target=_blank>i.congm.in/cqupt-inner</a></p> <p>统计：<a href="http://new.cnzz.com/v1/login.php?siteid=1257517721" target=_blank>CNZZ统计</a></p> <p>作者：<a href=//congm.in target=_blank>@ Cong Min</a></p> </div> </div> </div> </div> </div> <div id=_cqupt-adbox> <ins class=adsbygoogle style=display:block data-ad-client=ca-pub-9908918414837596 data-ad-slot=4401312664 data-ad-format=auto></ins> <script>console.log("test"),(adsbygoogle=window.adsbygoogle||[]).push({}),(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-9908918414837596",enable_page_level_ads:!0})</script> </div>'},function(e,t){e.exports=[{user_id:"187***9149",user_name:"文",time:"2016-12-25",money:6.66},{user_id:"138***3218",user_name:"代琪",time:"2016-12-22",money:6.66},{user_id:"hml***@126.com",user_name:"茂梁",time:"2016-12-02",money:10},{user_id:"177***2728",user_name:"huhaosb",time:"2016-11-29",money:.1},{user_id:"136***9209",user_name:"Guan",time:"2016-11-20",money:10},{user_id:"152***9011",user_name:"穗乃果家的馒头",time:"2016-11-14",money:9.12},{user_id:"158***5091",user_name:"姜一凡",time:"2016-11-08",money:1.2},{user_id:"183***1479",user_name:"Aven",time:"2016-10-31",money:2},{user_id:"163***@qq.com",user_name:"宝童",time:"2016-10-25",money:6.66},{user_id:"173***1325",user_name:"Tritagonist",time:"2016-10-20",money:6},{user_id:"qxy***@163.com",user_name:"小勇",time:"2016-10-13",money:6},{user_id:"kin***@qq.com",user_name:"kindvin",time:"2016-09-13",money:5},{user_id:"188***1285",user_name:"LoveYourLove",time:"2016-09-13",money:5},{user_id:"188***4404",user_name:"秋健",time:"2016-09-13",money:8},{user_id:"183***1479",user_name:"Aven",time:"2016-09-12",money:1},{user_id:"734***@qq.com",user_name:"JohnZhu1997",time:"2016-09-11",money:5},{user_id:"188***1305",user_name:"权奥",time:"2016-09-11",money:5},{user_id:"156***4460",user_name:"Hypernova",time:"2016-09-09",money:5},{user_id:"109***@qq.com",user_name:"铮",time:"2016-09-08",money:10},{user_id:"181***6814",user_name:"文慧~",time:"2016-09-07",money:1}]},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAflBMVEVHcEw4ODg1NTUvLy8xMTEzMzMwMDAzMzM2NjYyMjIzMzMxMTEzMzMyMjIzMzMyMjIyMjIzMzMzMzMyMjI1NTUyMjIzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMyMjIzMzMzMzMyMjIzMzMzMzMzMzM6zPdjAAAAKXRSTlMAEhMbJNIV2xzjGRoUztrZz9HQ2BjT1zsjvdy3zUWupJTHMrCWnpypuWzxzngAAAE+SURBVFjD7dVbU8IwEIbh0CqtKKJgOQkqHoD8/z9ISGMG6Gaz3+qVY+52Ou8zbTptjPkja93sarSZfwxncVhZW4HC1Y21izi9WlQ49vYtjk9TUPD9sGe0QqcHBaJ3wkQskL0xA6mQ6MWC7x961CWRwPQige2dMMoImT4rtH3B3SIr+H5c8Jt0mxZEPSMI+6Qg7p1wTwhATwq+fyykn2tHAPuO0PZ3yC+rPBUU/Zmg6p1QBcH313AfBXUfhKW+D8IPemPq5bFv+uoz0z8/fOpd9nrB902lFtr316+1QujdTuqE2CuFk14lnPUK4aKHhU4PCkQPCWQPCIleLCR7ocD0IoHtBUKmzwrZPiMIelYQ9Ywg7JOCuE8IQE8KUE8Ic6z/Fso4v4B9EL7iuEH7VniO02zxCZ9/5Xb/bv7Xr6wDN1lBlbRjKkIAAAAASUVORK5CYII="},function(e,t){!function(e,t,s){function a(){return l.short_name?g+"//"+l.short_name+"."+C.DOMAIN:C.REMOTE}function n(){function t(){for(var t;t=b.shift();){var a=t.url,n=new s(t.title,{dir:"auto",icon:t.iconUrl,body:t.body});try{n.onclick=function(){e.focus(),h.href=a,n.close()}}catch(i){}setTimeout(function(){n.close&&n.close()},8e3)}}var s=e.Notification;"Notification"in e&&"denied"!==s.permission&&("granted"===s.permission&&t(),s.requestPermission(function(e){"granted"===e&&t()}))}function i(){return 0==re.data.user_id}function r(e){C.theme=e,"none"!=e&&o.injectStylesheet(C.STATIC_URL+"/styles/embed"+(e?"."+e+".css?"+N[e]:"."+short_name)+".css")}var o={},d=t.getElementsByTagName("head")[0]||t.getElementsByTagName("body")[0];if(o.extend=function(e,t){for(var s in t)e[s]=t[s];return e},o.injectScript=function(a,n){var i=t.createElement("script"),r=t.head||t.getElementsByTagName("head")[0]||t.documentElement;i.type="text/javascript",i.src=a,i.async="async",i.charset="utf-8",n&&(i.onload=i.onreadystatechange=function(t,a){var o=a||!i.readyState||/loaded|complete/.test(i.readyState);o&&(i.onload=i.onreadystatechange=null,r&&i.parentNode&&r.removeChild(i),i=s,a||n.call(e))}),r.insertBefore(i,r.firstChild)},o.injectStylesheet=function(e){var s=t.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=e,d.appendChild(s)},o.injectStyle=function(e){var s=t.createElement("style");return s.type="text/css",d.appendChild(s),e=e.replace(/\}/g,"}\n"),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(t.createTextNode(e)),s},o.getCookie=function(e){for(var a,n,i,r=" "+e+"=",o=t.cookie.split(";"),d=0;d<o.length;d++)if(a=" "+o[d],n=a.indexOf(r),n>=0&&n+r.length==(i=a.indexOf("=")+1))return decodeURIComponent(a.substring(i,a.length).replace(/\+/g,""));return s},o.param=function(e){var t=[];for(var a in e)e[a]!=s&&t.push(a+"="+encodeURIComponent(e[a]));return t.join("&")},o.cssProperty=function(e,s){var a=(t.body||t.documentElement).style;if("undefined"==typeof a)return!1;if("string"==typeof a[e])return!s||e;for(var n=["Moz","Webkit","ms"],e=e.charAt(0).toUpperCase()+e.substr(1),i=0;i<n.length;i++)if("string"==typeof a[n[i]+e])return!s||n[i]+e},!e.DUOSHUO){for(var c in Object.prototype)return alert("Object.prototype 不为空，请不要给 Object.prototype 设置方法");var l,u,p=e.JSON,h=e.location,m=e.XMLHttpRequest,f=p&&p.stringify&&e.localStorage,v=e.navigator.userAgent,g="https:"==t.location.protocol?"https:":"http:",_=0,b=[],y=u=function(){function e(e){return t[e]||"&amp;"}var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},s=/&(?!\w+;)|[<>"'`]/g,a=/[&<>"'`]/;return function(t){return null==t||t===!1?"":a.test(t)?t.replace(s,e):t}}(),q=function(e){if(e.match(/^(http|https):/))return e;var s=t.createElement("a");return s.href=e,M.hrefNormalized?s.href:s.getAttribute("href",4)},w=function(e){return function(){return e}},x=function(){for(var e={},t=0;t<arguments.length;t++)arguments[t]&&o.extend(e,arguments[t]);var s=o.param(e);return s?"?"+s:""},k=function(){var e=o.getCookie("duoshuo_token");return e?{jwt:e}:l.remote_auth?{short_name:l.short_name,remote_auth:l.remote_auth}:s},T=function(){if(!l&&(l=e.duoshuoQuery)){if(!l.short_name||"your_duoshuo_short_name"===l.short_name)return l=s,void alert("你还没有设置多说域名(duoshuoQuery.short_name)，填入已有域名或创建新站点：http://duoshuo.com/create-site/");ne.trigger("queryDefined")}return l},S=function(e){return e&&e.error&&e.warn?e:{error:function(){},log:function(){},warn:function(){}}}(e.console),C=e.DUOSHUO={sourceName:{weibo:"新浪微博",qq:"QQ",qzone:"QQ空间",qqt:"腾讯微博",renren:"人人网",douban:"豆瓣网",netease:"网易微博",kaixin:"开心网",sohu:"搜狐微博",baidu:"百度",taobao:"淘宝",msn:"MSN",google:"谷歌",weixin:"微信",wechat:"微信",diandian:"点点网",duitang:"堆糖",youdao:"有道云笔记",pengyou:"朋友网",facebook:"Facebook",twitter:"Twitter",linkedin:"Linkedin",huaban:"花瓣网",mogujie:"蘑菇街",meilishuo:"美丽说"},serviceNames:{weibo:"微博",qq:"QQ",douban:"豆瓣",renren:"人人",netease:"网易",kaixin:"开心",sohu:"搜狐",baidu:"百度",taobao:"淘宝",msn:"MSN",google:"谷歌",weixin:"微信",wechat:"微信",diandian:"点点",duitang:"堆糖",youdao:"有道云笔记",pengyou:"朋友网",facebook:"Facebook",twitter:"Twitter",linkedin:"Linkedin",huaban:"花瓣网",mogujie:"蘑菇街",meilishuo:"美丽说"},parseDate:function(e){return e.parse("2011-10-28T00:00:00+08:00")&&function(t){return new e(t)}||e.parse("2011/10/28T00:00:00+0800")&&function(t){return new e(t.replace(/-/g,"/").replace(/:(\d\d)$/,"$1"))}||e.parse("2011/10/28 00:00:00+0800")&&function(t){return new e(t.replace(/-/g,"/").replace(/:(\d\d)$/,"$1").replace("T"," "))}||function(t){return new e(t)}}(Date),fullTime:function(e){var t=C.parseDate(e);return t.getFullYear()+"年"+(t.getMonth()+1)+"月"+t.getDate()+"日 "+t.toLocaleTimeString()},elapsedTime:function(e){var t=C.parseDate(e),s=new Date,a=(s-_-t)/1e3;return 10>a?"刚刚":60>a?Math.round(a)+"秒前":3600>a?Math.round(a/60)+"分钟前":86400>a?Math.round(a/3600)+"小时前":(s.getFullYear()==t.getFullYear()?"":t.getFullYear()+"年")+(t.getMonth()+1)+"月"+t.getDate()+"日"},compileStyle:function(e){var t="",s={};if(s.textbox="#ds-thread #ds-reset .ds-replybox .ds-textarea-wrapper",!e)return t;for(var a in e)t+=s[a]+"{"+e[a]+"}\n";return t},init:function(e,t){e&&!z[e]&&(z[e]=t||{type:"EmbedThread"}),C.initView&&C.initView()}},j=t.all,M=C.support=function(){var s=t.createElement("div");s.innerHTML='<a href="/a" style="opacity:.55;">a</a><input type="checkbox"/>';var a=s.getElementsByTagName("a")[0],n=s.getElementsByTagName("input")[0],i={placeholder:"placeholder"in n,touch:"ontouchstart"in e||"onmsgesturechange"in e,opacity:/^0.55$/.test(a.style.opacity),hrefNormalized:"/a"===a.getAttribute("href"),iOS:v.match(/ \((iPad|iPhone|iPod);( U;)? CPU( iPhone)? OS /),android:v.match(/ \(Linux; U; Android /)};return i.ie6=!m&&"undefined"==typeof s.style.maxHeight,i.authInWin=e.postMessage&&e.screen.width>800&&!i.iOS&&!i.android&&h.origin,i}(),z=C.selectors={".ds-thread":{type:"EmbedThread"},".ds-recent-comments":{type:"RecentComments"},".ds-recent-visitors":{type:"RecentVisitors"},".ds-top-users":{type:"TopUsers"},".ds-top-threads":{type:"TopThreads"},".ds-login":{type:"LoginWidget"},".ds-thread-count":{type:"ThreadCount"},".ds-share":{type:"ShareWidget"}},E=C.openDialog=function(e){return C.dialog!==s&&C.dialog.el.remove(),C.dialog=new se.Dialog(ee.dialog(e)).open()},A=C.smilies={};C.require=function(){function t(e){var t=U[e]?"?"+U[e]+".js":"";return C.STATIC_URL+"/libs/"+e+".js"+t}var s={mzadxN:"undefined"!=typeof mzadxN};return"undefined"!=typeof jQuery&&jQuery.fn.jquery>="1.5"&&(s["embed.compat"]=!0,C.jQuery=e.jQuery),function(e,a){if("string"==typeof e)s[e]?a():o.injectScript(t(e),function(){s[e]=!0,a()});else if("object"==typeof e){var n,i=!0;for(n=0;n<e.length;n++)(function(r){s[e[n]]||(i=!1,o.injectScript(t(r),function(){s[r]=!0;for(var t=0;t<e.length;t++)if(!s[e[t]])return;a()}))})(e[n]);i&&a()}}}();for(var O=0,L=["EmbedThread","RecentComments","RecentVisitors","TopUsers","TopThreads","LoginWidget","ThreadCount"];O<L.length;O++)C[L[O]]=function(e){return function(t,s){s=s||{},s.type=e,t&&!z[t]&&(z[t]=s),C.initSelector&&C.initSelector(t,s)}}(L[O]),C["create"+L[O]]=function(e){return function(s,a){var n=t.createElement(s);for(var i in a)n.setAttribute("data-"+i,a[i]);return C[e](n),n}}(L[O]);C.RecentCommentsWidget=C.RecentComments;var I=C.API={ajax:function(e,t,n,i,r){function d(e){var t=e.getResponseHeader("Date");t&&(_=new Date-new Date(t))}function c(e,t,s){var a,n,o,c=t;if(e>=200&&300>e||304===e)if(304===e)c="notmodified",o=!0;else try{a=p.parse(s),c="success",o=!0}catch(l){c="parsererror",n=l}else{n=c,(!c||e)&&(c="error",0>e&&(e=0));try{a=p.parse(s)}catch(l){c="parsererror",n=l}}o?i&&i(a):"parseerror"===c?S.error("解析错误: "+s):(S.error("出错啦("+a.code+"): "+a.errorMessage),r&&r(a),a.errorTrace&&S.error(a.errorTrace)),d(f)}var u=o.getCookie("duoshuo_token");n=n||{},n.v=C.version,u?n.jwt=u:l.remote_auth&&(n.remote_auth=l.remote_auth);var h=m&&p&&p.parse;if(h){var f=new m,v=!!f&&"withCredentials"in f;if(v){var g;return f.open(e,a()+"/api/"+t+".json"+("GET"==e?"?"+o.param(n):""),!0),f.withCredentials=!0,f.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),f.send("GET"==e?null:o.param(n)),g=function(e,t){var a,n,i,r;try{if(g&&(t||4===f.readyState))if(g=s,t)4!==f.readyState&&f.abort();else{a=f.status,i=f.getAllResponseHeaders();try{r=f.responseText}catch(e){}try{n=f.statusText}catch(o){n=""}}}catch(d){t||c(-1,d)}r&&c(a,n,r,i)},void(4===f.readyState?g():f.onreadystatechange=g)}}"GET"!=e&&(n._method="POST");var b="cb_"+Math.round(1e6*Math.random());I[b]=function(e){switch(e.code){case 0:i&&i(e);break;default:r&&r(e),S.error("出错啦("+e.code+"): "+e.errorMessage),e.errorTrace&&S.error(e.errorTrace)}},n.callback="DUOSHUO.API['"+b+"']",o.injectScript(a()+"/api/"+t+".jsonp?"+o.param(n))},get:function(e,t,s,a){return this.ajax("GET",e,t,s,a)},post:function(e,t,s,a){return this.ajax("POST",e,t,s,a)}},P=C.ws={messages:[],send:function(s){if(!("WebSocket"in e&&p))return!1;var a=this;if(a.messages.push(p.stringify(s)),!a.webSocket){var i="https:"===t.location.protocol?"wss://ws.duoshuo.com:8202/":"ws://ws.duoshuo.com:8201/",r=a.webSocket=new WebSocket(i);r.onopen=function(){var e,t=1===r.readyState;if(t)for(;e=a.messages.shift();)r.send(e)},r.onmessage=function(e){try{var t=p.parse(e.data)}catch(s){return}switch(t.type){case"post":for(var a,i=0;i<C.pagelets.length;i++)a=C.pagelets[i],a.threadId==t.thread_id&&a.onMessage(t);break;case"notification":b.push(t),n()}},e.addEventListener("beforeunload",function(){r.close()})}a.webSocket.onopen()}};C.DOMAIN="duoshuo.com",C.STATIC_URL=g+"//static.duoshuo.com",C.REMOTE=g+"//duoshuo.com",C.version="16.2.29";var N={"default":"349d9313",dark:"98c35833",bluebox:"f5f8b5e5",newhua:"8aa14220",justflat:"f88d0982"},U={"embed.compat":"24f8ca3f",smilies:"921e8eda"},R={post:"发布",posting:"正在发布",settings:"设置",reply:"回复",like:"顶",repost:"转发",report:"举报","delete":"删除",reply_to:"回复 ",reposts:"转发",comments:"评论",floor:"楼",latest:"最新",earliest:"最早",hottest:"最热",share_to:"分享到:",leave_a_message:"说点什么吧…",no_comments_yet:"还没有评论，沙发等你来抢",repost_reason:"请输入转发理由",hot_posts_title:"被顶起来的评论",comments_zero:"暂无评论",comments_one:"1条评论",comments_multiple:"{num}条评论",reposts_zero:"暂无转发",reposts_one:"1条转发",reposts_multiple:"{num}条转发",weibo_reposts_zero:"暂无新浪微博",weibo_reposts_one:"1条新浪微博",weibo_reposts_multiple:"{num}条新浪微博",qqt_reposts_zero:"暂无腾讯微博",qqt_reposts_one:"1条腾讯微博",qqt_reposts_multiple:"{num}条腾讯微博"},D={get:function(e){return f?f[e]:void 0},save:function(e,t){if(f)try{f.removeItem(e),f[e]=p.stringify(t),f.removeItem(e+":timestamp"),f[e+":timestamp"]=Math.floor((new Date-_)/1e3)}catch(s){}}},H=C.loadRequire=function(t){if(t.visitor&&(!re.data&&t.visitor.user_id&&e.Notification&&P.send({logged_user_id:t.visitor.user_id}),re.reset(t.visitor)),t.site&&(ie.reset(t.site),D.save("ds_site_"+l.short_name,t.site)),!C.theme&&ie.data.theme&&r(ie.data.theme),t.lang&&(o.extend(R,t.lang),D.save("ds_lang_"+l.short_name,t.lang)),t.stylesheets)for(var s=0;s<t.stylesheets.length;s++)o.injectStylesheet(t.stylesheets[s]);if(t.nonce&&(C.nonce=t.nonce),t.style&&o.injectStyle((t.style||"")+C.compileStyle(l.component_style)),t.unread&&oe.reset(t.unread),t.warnings)for(var s=0;s<t.warnings.length;s++)S.warn(t.warnings[s])},J=0,B=C.Class=function(){};B.extend=function(e){function t(){!J&&this.init&&this.init.apply(this,arguments)}J=1;var s=new this;J=0;for(var a in e)s[a]=e[a];return t.prototype=s,t.prototype.constructor=t,t.extend=arguments.callee,t};var W=C.Event=B.extend({on:function(e,t){var a=this.handlers||(this.handlers={});return a[e]===s&&(a[e]=[]),a[e].push(t),this},trigger:function(e,t){var s=(this.handlers||(this.handlers={}))[e];if(s)for(var a=0;a<s.length&&s[a].call(this,t)!==!1;a++);return this}}),Q=C.Widget=W.extend({init:function(e,t){this.el=e,this.options=t||{},this.render()},render:function(){},reset:function(){},load:function(e){switch(e.code){case 0:H(e);var t=this.prepare(e);t.options=o.extend(this.options,e.options),this.onload(t);break;default:this.onError(e)}},onload:function(e){this.el.html(ee[this.tmpl](e))},prepare:function(e){return e},onMessage:function(){},onError:function(e){S.error("出错啦("+e.code+"): "+e.errorMessage),e.errorTrace&&S.error(e.errorTrace)}}),V=C.Model=W.extend({init:function(e){this.data=e},reset:function(e){this.data=e,this.trigger("reset")},remove:function(e){this.data.splice(e,1),this.trigger("reset")},set:function(e,t){if(t===s)for(var a in e)this.data[a]=e[a];else this.data[e]=t;return this.trigger("reset"),this},toJSON:function(){return o.extend({},this.data)}}),K=V.extend({toJSON:function(){return o.extend({},this.data)}}),Z=V.extend({toJSON:function(){var e=o.extend({},this.data);return e.theAuthor=le[this.data.author_id]&&le[this.data.author_id].data||this.data.author,e.parents=this.data.parents||[],e}}),F=V.extend({toJSON:function(){return o.extend({},this.data)}}),G=function(e){this.model=e};G.prototype.set=function(e){for(var t in e)e[t]&&(this[t]?this[t].set(e[t]):this[t]=new this.model(e[t]))},G.prototype.get=function(e){for(var t=0,s=[];t<e.length;t++)s[t]=this[e[t]];return s},G.prototype.getJSON=function(e){for(var t=0,s=[];t<e.length;t++)this[e[t]]&&s.push(this[e[t]].toJSON());return s};var Y={userUrl:function(e){return e.url},avatarUrl:function(e){return e.avatar_url?e.avatar_url="https:"==document.location.protocol?e.avatar_url.replace(/^http\:\/\//,"https://congm.in/proxy/"):e.avatar_url:re.data.default_avatar_url="https://congm.in/proxy/ds.cdncache.org/avatar-50/763/222267.jpg",e.avatar_url||re.data.default_avatar_url},loginUrl:function(e,t){return t||(t={}),l.sso&&l.sso.login&&(t.sso=1,t.redirect_uri=l.sso.login),a()+"/login/"+e+"/"+x(t)},bindUrl:function(e){return a()+"/bind/"+e+"/"+x(l.sso&&l.sso.login?{sso:1,redirect_uri:l.sso.login}:null,k())},logoutUrl:function(){return a()+"/logout/"+x(l.sso&&l.sso.logout?{sso:1,redirect_uri:l.sso.logout}:null)}},$=["weixin","weibo","qq","renren"],X=["douban","kaixin","baidu","google"],ee=C.templates={userAnchor:function(e){return e.url?'<a rel="nofollow author" target="_blank" href="'+y(e.url)+'">'+y(e.name)+"</a>":y(e.name)},avatarImg:function(e,t){return'<img src="'+y(Y.avatarUrl(e,t))+'" alt="'+y(e.name)+'"'+(t?' style="width:'+t+"px;height:"+t+'px"':"")+"/>"},avatar:function(e,t){var s=ee.avatarImg(e,t),n=Y.userUrl(e);return n?'<a rel="nofollow author" target="_blank" href="'+y(n)+'" '+(e.user_id?" onclick=\"this.href='"+a()+"/user-url/?user_id="+e.user_id+"';\"":"")+' title="'+y(e.name)+'">'+s+"</a>":s},timeText:function(e){return e?'<span class="ds-time" datetime="'+e+'" title="'+C.fullTime(e)+'">'+C.elapsedTime(e)+"</span>":""},timeAnchor:function(e,t){return e?'<a href="'+t+'" target="_blank" rel="nofollow" class="ds-time" datetime="'+e+'" title="'+C.fullTime(e)+'">'+C.elapsedTime(e)+"</a>":""},serviceIcon:function(e,t){return'<a href="javascript:void(0)" class="ds-service-icon'+(t?"-grey":"")+" ds-"+e+'" data-service="'+e+'" title="'+C.sourceName[e]+'"></a>'},poweredBy:function(e){return'<p class="ds-powered-by"><a href="http://duoshuo.com" target="_blank" rel="nofollow">'+y(e)+"</a></p>"},indicator:w('<div id="ds-indicator"></div>'),waitingImg:w('<div id="ds-waiting"></div>'),loginItem:function(e,t){var s=Y[t?"bindUrl":"loginUrl"](e);return'<li>    <a href="'+s+'" rel="nofollow" class="ds-service-link ds-'+e+'">'+C.serviceNames[e]+(re.data.social_uid[e]?' <span class="ds-icon ds-icon-ok"></span>':"")+"</a></li>"}},te=function(e){var t=[];for(var s in e)t.push('<input type="hidden" name="'+s+'" value="'+y(e[s])+'" />');return t.join("\n")};ee.commentList=function(e){var t="",s=e.list;if(s)for(var a,n=-1,i=s.length-1;i>n;)a=s[n+=1],t+='<li class="ds-comment',e.options.show_avatars&&(t+=" ds-show-avatars"),t+='" data-post-id="'+a.post_id+'">',e.options.show_avatars&&(t+='<div class="ds-avatar">'+ee.avatar(a.theAuthor,e.options.avatar_size)+"</div>"),t+='<div class="ds-meta">'+ee.userAnchor(a.theAuthor),
e.options.show_time&&(t+=ee.timeText(a.created_at)),t+="</div>",t+=e.options.show_title?'<div class="ds-thread-title">在 <a href="'+u(a.thread.url)+'#comments">'+u(a.thread.title)+'</a> 中评论</div><div class="ds-excerpt">'+a.message+"</div>":'<a class="ds-excerpt" title="'+a.thread.title+' 中的评论" href="'+u(a.thread.url)+'#comments">'+a.message+"</a>",t+="</li>";return t},ee.ctxPost=function(e){var t="";return e.post&&(t+='<li class="ds-ctx-entry"',e.hidden&&(t+=' style="display:none"'),t+=' data-post-id="'+e.post.post_id+'"><div class="ds-avatar">'+ee.avatar(e.post.theAuthor||e.post.author)+'</div><div class="ds-ctx-body"><div class="ds-ctx-head">'+ee.userAnchor(e.post.theAuthor||e.post.author)+ee.timeAnchor(e.post.created_at,e.post.url),e.index>=0&&(t+='<div class="ds-ctx-nth" title="'+C.fullTime(e.post.created_at)+'">'+(e.index+1)+R.floor+"</div>"),t+='</div><div class="ds-ctx-content">'+e.post.message,e.index>=0&&(t+='　　　　　　　<div class="ds-comment-actions',e.post.vote>0&&(t+=" ds-post-liked"),t+='">'+ee.likePost(e.post)+'<a class="ds-post-repost" href="javascript:void(0);"><span class="ds-icon ds-icon-share"></span>'+R.repost+'</a><a class="ds-post-reply" href="javascript:void(0);"><span class="ds-icon ds-icon-reply"></span>'+R.reply+"</a></div>"),t+="</div></div></li>"),t},ee["dialog-anonymous"]=function(e){var t='<h2>社交帐号登录</h2><div class="ds-icons-32">',s=e.services;if(s)for(var a,n=-1,i=s.length-1;i>n;)a=s[n+=1],t+='<a class="ds-'+a+'" href="'+Y.loginUrl(a)+'">'+C.sourceName[a]+"</a>";return t+="</div>",e.options.deny_anonymous||(t+='<h2>作为游客留言</h2><form><div class="ds-control-group"><input type="text" name="author_name" id="ds-dialog-name" value="'+u(re.data.name)+'" required /><label for="ds-dialog-name">名字(必填)</label></div>',e.options.require_guest_email&&(t+='<div class="ds-control-group"><input type="email" name="author_email" id="ds-dialog-email" value="'+u(re.data.email)+'" required /><label for="ds-dialog-email">邮箱(必填)</label></div>'),e.options.require_guest_url&&(t+='<div class="ds-control-group"><input type="url" name="author_url" id="ds-dialog-url" placeholder="http://" value="'+u(re.data.url)+'" /><label for="ds-dialog-url">网址(可选)</label></div>'),t+='<button type="submit">发布</button></form>'),t},ee["dialog-ask-for-auth"]=function(){var e='<h2>社交帐号登录</h2><ul class="ds-service-list">'+ee.serviceList($)+'</ul><ul class="ds-service-list ds-additional-services">'+ee.serviceList(X)+"</ul>";return e},ee["dialog-bind-more"]=function(){var e='<h2>绑定更多帐号</h2><ul class="ds-service-list">'+ee.serviceBindList($)+'</ul><ul class="ds-service-list ds-additional-services">'+ee.serviceBindList(X)+'</ul><div style="clear:both"></div>';return e},ee["dialog-qrcode"]=function(e){var t='<h2>微信扫一扫，分享到朋友圈</h2><div class="ds-share-qrcode" style="text-align:center;"><img src="'+e.qrcode_url+'" alt="'+e.url+'"></div>';return t},ee["dialog-reposts"]=function(e){var t='<h2>转发到微博</h2><div class="ds-quote"><strong>@'+u(e.post.theAuthor.name)+"</strong>: "+e.post.message+"</div><form>"+te({post_id:e.post.post_id})+'<div class="ds-textarea-wrapper"><textarea name="message" title="Ctrl+Enter快捷提交" placeholder="'+u(R.repost_reason)+'">'+u(e.repostMessage)+'</textarea><pre class="ds-hidden-text"></pre>';return t+='</div><div class="ds-actions">',e.service?t+=te({"service[]":e.service}):(t+='<label><input type="checkbox" name="service[]" value="weibo"',re.data.social_uid.weibo&&(t+=' checked="checked"'),t+=' /><span class="ds-service-icon ds-weibo"></span>新浪微博</label><label><input type="checkbox" name="service[]" value="qqt"',re.data.social_uid.qq&&(t+=' checked="checked"'),t+=' /><span class="ds-service-icon ds-qqt"></span>腾讯微博</label>'),t+='<button type="submit">'+R.repost+"</button></div></form>"},ee.dialog=function(e){var t='<div class="ds-dialog"><div class="ds-dialog-inner ds-rounded"><div class="ds-dialog-body">'+e+'</div><div class="ds-dialog-footer"><a href="http://duoshuo.com/" target="_blank" class="ds-logo"></a><span>社会化评论框</span></div><a class="ds-dialog-close" href="javascript:void(0)" title="关闭"></a></div></div>';return t},ee.hotPosts=function(e){var t='<div class="ds-header ds-gradient-bg">'+u(R.hot_posts_title)+"</div><ul>",s=e.list;if(s)for(var a,n=-1,i=s.length-1;i>n;)a=s[n+=1],t+=ee.post({post:a,options:e.options});return t+="</ul>"},ee.likePost=function(e){var t='<a class="ds-post-likes" href="javascript:void(0);"><span class="ds-icon ds-icon-like"></span>'+R.like;return e.likes>0&&(t+="("+e.likes+")"),t+="</a>"},ee.likeTooltip=function(e){var t='<div class="ds-like-tooltip ds-rounded"><p>很高兴你能喜欢，分享一下吧：</p><ul>';for(var s in e.services)t+='<li><a class="ds-share-to-'+s+" ds-service-link ds-"+s+'" href="'+a()+"/share-proxy/?"+o.param({service:s,thread_id:e.thread_id})+'">'+e.services[s]+"</a></li>";return t+='</ul><p class="ds-like-tooltip-footer"><a class="ds-like-tooltip-close">算了</a></p></div>'},ee.loginButtons=function(){var e='<div class="ds-login-buttons"><p>社交帐号登录:</p><div class="ds-social-links"><ul class="ds-service-list">'+ee.serviceList($)+'<li><a class="ds-more-services" href="javascript:void(0)">更多»</a></li></ul><ul class="ds-service-list ds-additional-services">'+ee.serviceList(X)+"</ul></div></div>";return e},ee.loginWidget=function(e){var t='<div class="ds-icons-32">',s=e;if(s)for(var a,n=-1,i=s.length-1;i>n;)a=s[n+=1],t+='<a class="ds-'+a+'" href="'+Y.loginUrl(a)+'">'+C.sourceName[a]+"</a>";return t+="</div>"},ee.meta=function(e){var t='<div class="ds-meta"><a href="javascript:void(0)" class="ds-like-thread-button ds-rounded';return e.user_vote>0&&(t+=" ds-thread-liked"),t+='"><span class="ds-icon ds-icon-heart"></span> <span class="ds-thread-like-text">',t+=e.user_vote>0?"已喜欢":"喜欢",t+='</span><span class="ds-thread-cancel-like">取消喜欢</span></a><span class="ds-like-panel"></span></div>'},ee.notify=function(e){var t='<div id="ds-reset"><a class="ds-logo" href="http://duoshuo.com/" target="_blank" title="多说"></a><ul class="ds-notify-unread"><li';return e.comments||(t+=' style="display:none;"'),t+='><a data-type="unread-comments" href="javascript:void(0);">你有'+e.comments+"条新回复</a></li><li",e.notifications||(t+=' style="display:none;"'),t+='><a data-type="unread-notifications" href="javascript:void(0);">你有'+e.notifications+"条系统消息</a></li></ul></div>"},ee.post=function(e){var t="",s=e.post,n=e.options,i=s.author;if(t+='<li class="ds-post" data-post-id="'+s.post_id+'"><div class="ds-post-self" data-post-id="'+s.post_id+'" data-thread-id="'+s.thread_id+'" data-root-id="'+s.root_id+'" data-source="'+s.source+'"><div class="ds-avatar"',i.user_id&&(t+=' data-user-id="'+i.user_id+'"'),t+=">"+ee.avatar(i),C.sourceName[s.source]&&(t+=ee.serviceIcon(s.source)),t+='</div><div class="ds-comment-body"><div class="ds-comment-header">',i.url?(t+='<a class="ds-user-name ds-highlight" data-qqt-account="'+(i.qqt_account||"")+'" href="'+u(i.url)+'" ',i.user_id&&(t+=" onclick=\"this.href='"+a()+"/user-url/?user_id="+i.user_id+"';\""),t+=' rel="nofollow" target="_blank"',i.user_id&&(t+=' data-user-id="'+i.user_id+'"'),t+=">"+u(i.name)+"</a>"):(t+='<span class="ds-user-name"',i.user_id&&(t+=' data-user-id="'+i.user_id+'"'),t+=' data-qqt-account="'+(i.qqt_account||"")+'">'+u(i.name)+"</span>"),t+="</div>",1==n.max_depth&&n.show_context&&s.parents.length){t+='<ol id="ds-ctx">';var r=ce.getJSON(s.parents);if(r)for(var o,d=-1,c=r.length-1;c>d;)o=r[d+=1],1==d&&s.parents.length>2&&(t+='<li class="ds-ctx-entry"><a href="javascript:void(0);" class="ds-expand">还有'+(s.parents.length-2)+"条评论</a></li>"),t+=ee.ctxPost({post:o,index:d,hidden:d&&d<s.parents.length-1});t+="</ol>"}if(t+="<p>",s.parents.length>=n.max_depth&&(!n.show_context||n.max_depth>1)&&s.parent_id&&ce[s.parent_id]&&(t+='<a class="ds-comment-context" data-post-id="'+s.post_id+'" data-parent-id="'+s.parent_id+'">'+R.reply_to+u(ce[s.parent_id].toJSON().author.name)+": </a>"),t+=s.message+'</p><div class="ds-comment-footer ds-comment-actions',s.vote>0&&(t+=" ds-post-liked"),t+='">',t+=s.url?ee.timeAnchor(s.created_at,s.url):ee.timeText(s.created_at),"duoshuo"==s.source?(t+='<a class="ds-post-reply" href="javascript:void(0);"><span class="ds-icon ds-icon-reply"></span>'+R.reply+"</a>"+ee.likePost(s)+'<a class="ds-post-repost" href="javascript:void(0);"><span class="ds-icon ds-icon-share"></span>'+R.repost+'</a><a class="ds-post-report" href="javascript:void(0);"><span class="ds-icon ds-icon-report"></span>'+R.report+"</a>",s.privileges["delete"]&&(t+='<a class="ds-post-delete" href="javascript:void(0);"><span class="ds-icon ds-icon-delete"></span>'+R["delete"]+"</a>")):("qqt"==s.source||"weibo"==s.source)&&(t+='<a class="ds-weibo-comments" href="javascript:void(0);">'+R.comments,s.type.match(/\-comment$/)||(t+='(<span class="ds-count">'+s.comments+"</span>)"),t+='</a><a class="ds-weibo-reposts" href="javascript:void(0);">'+R.reposts,s.type.match(/\-comment$/)||(t+='(<span class="ds-count">'+s.reposts+"</span>)"),t+="</a>"),t+="</div></div></div>",n.max_depth>1&&(s.childrenArray||s.children)&&"weibo"!=s.source&&"qqt"!=s.source){t+='<ul class="ds-children">';var l=ce.getJSON(s.childrenArray||s.children);if(l)for(var s,d=-1,p=l.length-1;p>d;)s=l[d+=1],t+=ee.post({post:s,options:n});t+="</ul>"}return t+="</li>"},ee.postListHead=function(e){var t='<div class="ds-comments-info"><div class="ds-sort"><a class="ds-order-desc">'+R.latest+'</a><a class="ds-order-asc">'+R.earliest+'</a><a class="ds-order-hot">'+R.hottest+'</a></div><ul class="ds-comments-tabs"><li class="ds-tab"><a class="ds-comments-tab-duoshuo ds-current" href="javascript:void(0);"></a></li>';return e.options.show_reposts&&e.thread.reposts&&(t+='<li class="ds-tab"><a class="ds-comments-tab-repost" href="javascript:void(0);"></a></li>'),t+=" ",e.options.show_weibo&&e.thread.weibo_reposts&&(t+='<li class="ds-tab"><a class="ds-comments-tab-weibo" href="javascript:void(0);"></a></li>'),t+=" ",e.options.show_qqt&&e.thread.qqt_reposts&&(t+='<li class="ds-tab"><a class="ds-comments-tab-qqt" href="javascript:void(0);"></a></li>'),t+="</ul></div>"},ee.recentVisitors=function(e){var t="",s=e.response;if(s)for(var a,n=-1,i=s.length-1;i>n;)a=s[n+=1],t+='<div class="ds-avatar">'+ee.avatar(a,e.options.avatar_size)+"</div>";return t},ee["related-read"]=function(e){var t="";if(e&&e.length){t+='<article class="ds-reads-expand"><header>头条推荐</header><section> ';var s=e;if(s)for(var a,n=-1,i=s.length-1;i>n;){if(a=s[n+=1],t+=' <a href="'+a.url+'" class="ds-reads-item"> ',3==a.imgs.length){t+=" <h2>"+a.title+'</h2> <div class="ds-reads-pics"> <ul> ';var r=a.imgs;if(r)for(var o,d=-1,c=r.length-1;c>d;)o=r[d+=1],t+=' <li> <div class="ds-reads-dumb"></div> <div class="ds-reads-pic-wrap" style="background-image:url('+o+');"></div> </li> ';t+=' </ul> </div> <div class="ds-reads-info"> ',1==a.type&&(t+=' <span class="ds-reads-app-special">打开头条阅读</span> '),t+=' <span class="ds-reads-date" data-date="'+a.timeStamp+'"></span> </div> '}else t+=' <div class="ds-reads-desc ',a.imgs.length||(t+="ds-reads-only"),t+='"> <div class="ds-reads-title">'+a.title+'</div> <div class="ds-reads-info"> ',1==a.type&&(t+=' <span class="ds-reads-app-special">打开头条阅读</span> '),t+=' <span class="ds-reads-date" data-date="'+a.timeStamp+'"></span> </div> </div> ',a.imgs.length&&(t+=' <div class="ds-reads-pic-right"> <div class="ds-reads-dumb"></div> <div class="ds-reads-pic-wrap" style="background-image:url('+a.imgs[0]+');"> ',a.hasVideo&&(t+=' <div class="ds-reads-vid-info"><span>'+a.videoDuration+"</span></div> "),t+=" </div> </div> "),t+=" ";t+=" </a> "}t+="</section></article>"}return t},ee.replybox=function(e){var t='<div class="ds-replybox"><a class="ds-avatar"';if(t+=i()?' href="javascript:void(0);" onclick="return false"':' href="'+C.REMOTE+"/settings/avatar/"+x(k())+'" target="_blank" title="设置头像"',t+=">"+ee.avatarImg(re.data)+'</a><form method="post">'+te(e.params)+'<div class="ds-textarea-wrapper ds-rounded-top"><textarea name="message" title="Ctrl+Enter快捷提交" placeholder="'+u(R.leave_a_message)+'"></textarea><pre class="ds-hidden-text"></pre>',t+="</div>",t+='<div class="ds-post-toolbar"><div class="ds-post-options ds-gradient-bg"><span class="ds-sync">',!i()&&re.data.repostOptions){t+='<input id="ds-sync-checkbox',e.inline&&(t+="-inline"),t+='" type="checkbox" name="repost" ',e.checked&&(t+='checked="checked" '),t+='value="'+e.repostArray.join(",")+'"> <label for="ds-sync-checkbox',e.inline&&(t+="-inline"),t+='">'+R.share_to+"</label>";for(var s in re.data.repostOptions)t+=ee.serviceIcon(s,!re.data.repostOptions[s])}return t+="</span>",t+="</div>",t+='<button class="ds-post-button" type="submit">'+u(R.post)+'</button><div class="ds-toolbar-buttons">',e.options.use_smilies&&(t+='<a class="ds-toolbar-button ds-add-emote" title="插入表情"></a>'),e.options.use_images&&e.options.parse_html_enabled&&(t+='<a class="ds-toolbar-button ds-add-image" title="插入图片"></a>'),t+="</div></div>",t+="</form></div>"},ee.serviceBindList=function(e){var t="",s=e;if(s)for(var a,n=-1,i=s.length-1;i>n;)a=s[n+=1],t+='<li><a href="'+Y.bindUrl(a)+'" rel="nofollow" class="ds-service-link ds-'+a+'">'+C.serviceNames[a],re.data.social_uid[a]&&(t+=' <span class="ds-icon ds-icon-ok"></span>'),t+="</a></li>";return t},ee.serviceList=function(e){var t="",s=e;if(s)for(var a,n=-1,i=s.length-1;i>n;)a=s[n+=1],t+='<li><a href="'+Y.loginUrl(a)+'" rel="nofollow" class="ds-service-link ds-'+a+'">'+C.serviceNames[a]+"</a></li>";return t},ee.shareWidget=function(e){var t='<div class="ds-share-icons"> <div class="ds-share-icons-inner"> <ul class="ds-share-icons-16"> ',s=e.services;if(s)for(var a,n=-1,i=s.length-1;i>n;)a=s[n+=1],t+=' <li> <a class="ds-'+a+'" href="javascript:void(0);" data-service="'+a+'">'+C.sourceName[a]+"</a> </li> ";return t+=' </ul> </div> <div class="ds-share-icons-footer">'+e.copyright+"</div></div>"},ee.smiliesTooltip=function(e){var t='<div id="ds-smilies-tooltip"><ul class="ds-smilies-tabs">';for(var s in e)t+="<li><a>"+s+"</a></li>";return t+='</ul><div class="ds-smilies-container"></div></div>'},ee.toolbar=function(){var e='<div class="ds-toolbar"><div class="ds-account-control"><span class="ds-icon ds-icon-settings"></span> <span>帐号管理</span><ul><li><a class="ds-bind-more" href="javascript:void(0);" style="border-top: none">绑定更多</a></li><li><a target="_blank" href="'+C.REMOTE+"/settings/"+x(k())+'">'+u(R.settings)+'</a></li><li><a rel="nofollow" href="'+Y.logoutUrl()+'" style="border-bottom: none">登出</a></li></ul></div><div class="ds-visitor">';return e+=re.data.url?'<a class="ds-visitor-name" href="'+u(re.data.url)+'" target="_blank">'+u(re.data.name)+"</a>":'<span class="ds-visitor-name">'+u(re.data.name)+"</span>",e+='<a class="ds-unread-comments-count" href="javascript:void(0);" title="新回复"></a></div></div>'},ee.topThreads=function(e){var t="",s=e.response;if(s)for(var a,n=-1,i=s.length-1;i>n;)a=s[n+=1],t+='<li><a target="_blank" href="'+u(a.url)+'" title="'+u(a.title)+'">'+u(a.title)+"</a></li>";return t},ee.topUsers=function(e){var t="",s=e.response;if(s)for(var a,n=-1,i=s.length-1;i>n;)a=s[n+=1],t+='<div class="ds-avatar">'+ee.avatar(a,e.options.avatar_size)+"<h4>"+u(a.name)+"</h4></div>";return t},ee.userInfo=function(e){var t='<a href="'+u(e.url)+'" onclick="this.href=\''+a()+"/user-url/?user_id="+e.user_id+'\';" class="ds-avatar" target="_blank">'+ee.avatarImg(e)+'</a><a href="'+u(e.url)+'" onclick="this.href=\''+a()+"/user-url/?user_id="+e.user_id+'\';" class="ds-user-name ds-highlight" target="_blank">'+u(e.name)+"</a>";for(var s in e.social_uid)t+='<a href="'+C.REMOTE+"/user-proxy/"+s+"/"+e.social_uid[s]+'/" target="_blank" class="ds-service-icon ds-'+s+'" title="'+C.sourceName[s]+'"></a>';return t+='<p class="ds-user-card-meta"><a href="'+C.REMOTE+"/profile/"+e.user_id+'/" target="_blank"><span class="ds-highlight">'+e.comments+"</span>条评论</a></p>",e.description&&(t+='<p class="ds-user-description">'+u(e.description)+"</p>"),t};var se=C.Views={},ae=(C.Callbacks={},C.pagelets=[]),ne=C.events=new W,ie=C.site=new V,re=C.visitor=new K,oe=C.unread=new V,de=C.threadPool=new G(F),ce=C.postPool=new G(Z),le=C.userPool=new G(K);ne.on("queryDefined",function(){var e=l.short_name;if(l.theme&&r(l.theme),f){var t=f["ds_site_"+e],s=f["ds_lang_"+e];t&&ie.reset(p.parse(t)),s&&o.extend(R,p.parse(s))}}),T(),C.require("embed.compat",function(){function n(e){e.stopPropagation()}function r(e){(e.ctrlKey&&13==e.which||10==e.which)&&B(this.form).trigger("submit")}function d(){var e=B(this);e.height(Math.max(54,e.next(".ds-hidden-text").text(this.value).height()+27))}function c(){if(M.authInWin){var e=this.href.match(/\/(login|bind)\/(\w+)\//i);if(e&&C.serviceNames[e[2]])return!_(e[2],this.href)}}function u(){var e,s,a,n,i,r=this,o=0,d=0;t.selection&&(s=t.selection.createRange(),s&&s.parentElement()==r&&(n=r.value.length,e=r.value.replace(/\r\n/g,"\n"),a=r.createTextRange(),a.moveToBookmark(s.getBookmark()),i=r.createTextRange(),i.collapse(!1),a.compareEndPoints("StartToEnd",i)>-1?o=d=n:(o=-a.moveStart("character",-n),o+=e.slice(0,o).split("\n").length-1,a.compareEndPoints("EndToEnd",i)>-1?d=n:(d=-a.moveEnd("character",-n),d+=e.slice(0,d).split("\n").length-1)))),B(r).data("ds-range-start",o).data("ds-range-end",d)}function p(e){return M.touch&&e.addClass("ds-touch"),o.cssProperty("transition")||e.addClass("ds-no-transition"),M.ie6&&e.addClass("ds-ie6"),M.opacity||e.addClass("ds-no-opacity"),e}function m(e){if(!M.placeholder){var t=e.attr("placeholder");e.val(t).focus(function(){this.value===t&&(this.value="")}).blur(function(){""===this.value&&(this.value=t)})}return e}function g(e){if("http://duoshuo.com"===e.origin)switch(e.data.type){case"login":h.href=e.data.redirectUrl}}function _(t,s){var a={weibo:[760,600],renren:[420,322],qq:[504,445],weixin:[450,550],google:[600,440]}[t]||[550,400];return e.open(s+(-1==s.indexOf("?")?"?":"&")+o.param({origin:h.origin||"http://"+h.host}),"_blank","width="+a[0]+",height="+a[1]+",toolbar=no,menubar=no,location=yes")}function b(e){var t=Y[i()?"loginUrl":"bindUrl"](e);M.authInWin&&_(e,t)||(h.href=t)}function w(){var e=E(ee["dialog-ask-for-auth"]({})).el.find(".ds-dialog").css("width","300px");e.find("a.ds-service-link").click(c)}function x(e,t,s,a){function n(){function e(e){if(s&&a){var t=s.options,n=N(s.postList.el,e.response[a],t);"asc"==t.order==("top"==t.formPosition)&&C.scrollTo(n);var i=s.el.find(".ds-comments-tab-"+a+" span.ds-highlight");i.html(parseInt(i.html())+1)}}return a||c.find("[type=checkbox]:checked")[0]?(I.post("posts/repost",C.toJSON(c),e),o.close(),!1):(alert("还没有选发布到哪儿呢"),!1)}function i(){var e=this.value;return this.checked&&!re.data.social_uid["qqt"==e?"qq":e]?void b(e):void 0}var o=E(ee["dialog-reposts"]({post:e.toJSON(),repostMessage:t,service:a})),c=o.el.find("form");return c.submit(n),c.find(".ds-actions [type=checkbox]").change(i),m(c.find("textarea")).keyup(r).keyup(d).focus(),!1}function k(e){var t={"unread-comments":{title:"新留言及回复",apiUrl:"users/unreadComments",tmpl:function(e){return e.thread?'<li data-thread-id="'+e.thread.thread_id+'">'+B.map(e.authors,ee.userAnchor).join("、")+' 在 <a class="ds-read" href="'+e.thread.url+'#comments" target="_blank">'+y(e.thread.title||"无标题")+'</a> 中回复了你 <a class="ds-delete ds-read" title="知道了" href="javascript:void(0)">知道了</a></li>':""},read:function(e){var t=e.attr("data-thread-id");I.post("threads/read",{thread_id:t}),oe.data.comments--}},"unread-notifications":{title:"系统消息",apiUrl:"users/unreadNotifications",tmpl:function(e){return'<li data-notification-id="'+e.notification_id+'" data-notification-type="'+e.type+'">'+e.content+' <a class="ds-delete ds-read" title="知道了" href="javascript:void(0)">知道了</a></li>'},read:function(e){var t=e.attr("data-notification-id");I.post("notifications/read",{notification_id:t}),oe.data.notifications--}}}[e],s=E("<h2>"+t.title+'</h2><ul class="ds-unread-list"></ul>');s.on("close",C.resetNotify);var a=s.el.find(".ds-unread-list").delegate(".ds-delete","click",function(){return B(this).parent().remove(),0===a.children().length&&s.close(),!1}).delegate(".ds-read","click",function(){t.read(B(this).parent())});B("#ds-notify").hide(),I.get(t.apiUrl,{},function(e){s.el.find(".ds-unread-list").html(B.map(e.response,t.tmpl).join("\n"))})}function O(){bubbleOutTimer&&(clearTimeout(bubbleOutTimer),bubbleOutTimer=0)}function L(){bubbleOutTimer=setTimeout(function(){bubbleOutTimer=0,$.detach()},400)}function N(e,t,s){return e.find(".ds-post[data-post-id="+t.data.post_id+"]")[0]?void 0:(e.find(".ds-post-placeholder").remove(),B(ee.post({post:t.toJSON(),options:s})).hide()["asc"==s.order?"appendTo":"prependTo"](e).slideDown(function(){}))}function U(e,t){function s(){if(i())return w(),!1;var e=B(this).parent(),t=e.hasClass("ds-post-liked"),s=B(this).html().match(/\((\d+)\)/),a=(s?parseInt(s[1]):0)+(t?-1:1);return I.post("posts/vote",{post_id:e.closest(".ds-ctx-entry, .ds-post-self").attr("data-post-id"),vote:t?0:1}),B(this).html(B(this).html().replace(/\(\d+\)/,"")+(a?"("+a+")":"")),e[t?"removeClass":"addClass"]("ds-post-liked"),!1}function a(){var e=B(this).closest(".ds-post-self"),t=ce[e.attr("data-post-id")];return x(t,""),!1}function n(){if(!confirm("确定要删除这条评论吗？"))return!1;var t=B(this).closest(".ds-post-self");return I.post("posts/remove",{post_id:t.attr("data-post-id")}),t.parent().fadeOut(200,function(){e.data.comments--,e.updateCounter("duoshuo"),B(this).remove()}),!1}function r(){if(!confirm("确定要举报这条评论吗？"))return!1;var e=B(this).closest(".ds-post-self");return I.post("posts/report",{post_id:e.attr("data-post-id")}),alert("感谢您的反馈！"),!1}function o(){var s=B(this),a=s.closest(".ds-comment-actions");if(a.hasClass("ds-reply-active"))h.el.fadeOut(200,function(){B(this).detach()}),a.removeClass("ds-reply-active");else{var n=s.closest(".ds-ctx-entry, .ds-post-self");h?h.actionsBar.removeClass("ds-reply-active"):(h=new se.Replybox(e),h.render(!0).el.addClass("ds-inline-replybox").detach()),h.el.find("[name=parent_id]").val(n.attr("data-post-id")),h.el.show().appendTo(s.closest(".ds-ctx-body, .ds-comment-body")).find("textarea").focus(),h.actionsBar=a.addClass("ds-reply-active"),t.max_depth<=1?h.postList=e.postList.el:(h.postList=n.siblings(".ds-children"),h.postList[0]||(h.postList=B('<ul class="ds-children"></ul>').insertAfter(n)))}return!1}function d(){function e(e){H(e),n.append(B.map(e.response,function(e){return ee.post({post:e,options:t})}).join(""))}var s=B(this).closest(".ds-post-self"),a=s.attr("data-post-id");if(s.data("source"),0!=s.attr("data-root-id"))return!1;var n=s.siblings(".ds-children");return n[0]?(n.remove(),!1):(n=B('<ul class="ds-children"></ul>').insertAfter(s),I.get("posts/listComments",J({post_id:a}),e),!1)}function c(){var t=B(this).closest(".ds-post-self"),s=ce[t.attr("data-post-id")],a=s.data.source;if(!re.data.social_uid["qqt"==a?"qq":a])return void b(a);var n=s.data.root_id,i="0"!=n?ce[n]:s,r="";if("0"!=n){var o=prepatePost(s.data).theAuthor;r=("weibo"==a?"//@"+o.name:"|| @"+o.qqt_account)+":"+s.data.message}return x(i,r,e,a),!1}function l(){var e=B(this).parent();return e.siblings().show(),e.remove(),!1}function u(){function t(){function t(e){var t=e.response;le[l]?le[l].set(t):le[l]=new K(t),$.owner==s&&X.html(ee.userInfo(t))}te=0,$.owner=s,O();var n=a.offset(),i=e.el.offset(),r=a.innerWidth()/2,o=e.el.innerHeight()-(n.top-i.top)+6,d=n.left-i.left-35+(r>35?35:r);try{if(a.hasClass("ds-comment-context"))X.attr("id","ds-ctx-bubble").attr("data-post-id",a.attr("data-post-id")).html('<ul id="ds-ctx">'+ee.ctxPost({post:ce[a.attr("data-parent-id")].toJSON()})+'</ul><div class="ds-bubble-footer"><a class="ds-ctx-open" href="javascript:void(0);">查看对话</a></div>');else if(a.hasClass("ds-avatar")||a.hasClass("ds-user-name")){var c={},l=c.user_id=a.attr("data-user-id");if(!l)throw"no info";X.attr("id","ds-user-card").attr("data-user-id",l).empty(),le[l]?X.html(ee.userInfo(le[l].data)):I.get("users/profile",J(c),t)}$.css({bottom:o,left:d}).appendTo(e.innerEl)}catch(u){$.detach()}}var s=this;if(bubbleOutTimer&&$.owner==s)return clearTimeout(bubbleOutTimer),void(bubbleOutTimer=0);var a=B(s);te=setTimeout(t,200)}function p(){te?(clearTimeout(te),te=0):bubbleOutTimer||L()}var h;this.delegate("a.ds-post-likes","click",s).delegate("a.ds-post-repost","click",a).delegate("a.ds-post-delete","click",n).delegate("a.ds-post-report","click",r).delegate("a.ds-post-reply","click",o).delegate("a.ds-weibo-comments","click",d).delegate("a.ds-weibo-reposts","click",c).delegate("a.ds-expand","click",l),M.touch||this.delegate("a.ds-comment-context, .ds-avatar, .ds-user-name","mouseenter",u).delegate("a.ds-comment-context, .ds-avatar, .ds-user-name","mouseleave",p)}function J(e){var s={require:"site,visitor,nonce,lang"+(ne++?"":",unread,log,extraCss"),site_ims:D.get("ds_site_"+l.short_name+":timestamp"),lang_ims:D.get("ds_lang_"+l.short_name+":timestamp"),referer:t.referrer};l.stylePatch&&(s.style_patch=l.stylePatch);for(var a in s)s[a]&&(!M.ie6||encodeURIComponent(s[a]).length<200)&&(e[a]=s[a]);return e}var B=C.jQuery,V=B(e),G=B(t);e.postMessage&&(e.addEventListener?e.addEventListener("message",g,!1):e.attachEvent&&e.attachEvent("onmessage",g)),C.scrollTo=function(e){var t=e.offset().top;(t<V.scrollTop()||t>V.scrollTop()+V.height())&&B("html, body").animate({scrollTop:t-40},200,"swing")},C.toJSON=function(e){var t=/\r?\n/g,s=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,a=/^(?:select|textarea)/i,n=e.map(function(){return this.elements?B.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||a.test(this.nodeName)||s.test(this.type))}).map(function(e,s){var a=B(this).val();return null==a?null:B.isArray(a)?B.map(a,function(e){return{name:s.name,value:e.replace(t,"\r\n")}}):{name:s.name,value:a.replace(t,"\r\n")}}).toArray(),i={};return B.each(n,function(){i[this.name]=this.value}),i},C.resetNotify=function(){var e=B("#ds-notify"),s=oe.data;e[0]||(e=B('<div id="ds-notify"></div>').css({hidden:{display:"none"},"top-right":{top:"24px",right:"24px"},"bottom-right":{bottom:"24px",right:"24px"}}[ie.data.notify_position]).delegate(".ds-notify-unread a","click",function(){return k(B(this).data("type")),!1}).appendTo(t.body)),e.html(ee.notify(s))[!s.comments&&!s.notifications||"hidden"===ie.data.notify_position||B(".ds-dialog")[0]?"hide":"show"]()},oe.on("reset",C.resetNotify),se.Replybox=function(e){this.embedThread=e},se.Replybox.prototype={render:function(e){function s(e){e.data("submitting",!0),e.find(".ds-post-button").addClass("ds-waiting").html(R.posting)[0].disabled=!0}function a(e){e.data("submitting",!1),e.find(".ds-post-button").removeClass("ds-waiting").html(R.post)[0].disabled=!1}var n=this,o=n.embedThread,l=o.options,p=function(){C.require("smilies",function(){})},h={thread:o,options:l,inline:e,params:{thread_id:o.threadId,parent_id:"",nonce:C.nonce},repostArray:[],checked:0};for(var v in re.data.repostOptions)re.data.repostOptions[v]&&(h.repostArray.push(v),h.checked=1);var g=n.el=B(ee.replybox(h)).click(p),_=g.find("form"),b=_.find("input[type=checkbox]")[0],y=_.find("a.ds-service-icon, a.ds-service-icon-grey"),q=m(_.find("textarea")).focus(p).keyup(r).keyup(d).bind("focus mousedown mouseup keyup",u),w=g.find(".ds-add-emote").click(function(e){var s=C.smiliesTooltip;return w.toggleClass("ds-expanded").hasClass("ds-expanded")?(s||(s=C.smiliesTooltip=new se.SmiliesTooltip,s.render(),C.require("smilies",function(){s.reset("微博-默认")})),s.replybox=n,s.el.appendTo(t.body).css({top:n.el.offset().top+n.el.outerHeight()+4+"px",left:n.el.find(".ds-textarea-wrapper").offset().left+"px"}),B(t.body).click(x)):x(e),!1}),x=(g.find(".ds-add-image").click(function(e){var s=q[0],a=s.value,n="请输入图片地址",i='<img src="'+n+'" />';if(t.selection){s.value=a.substring(0,q.data("ds-range-start"))+i+a.substring(q.data("ds-range-end"),a.length),s.value=s.value.replace("说点什么吧 ...",""),s.focus();var r=t.selection.createRange();r.collapse(),r.findText(n),r.select()}else{s.value=a.substring(0,s.selectionStart)+i+a.substring(s.selectionEnd);var o=s.value.search(n);s.setSelectionRange(o,o+n.length),s.focus()}e.preventDefault()}),n.hideSmilies=function(){w.removeClass("ds-expanded"),C.smiliesTooltip.el.detach(),B(t.body).unbind("click",x)}),k=function(e,t){var s=E(ee["dialog-anonymous"]({services:["weixin","weibo","qq","renren","kaixin","douban"],options:l})),a=s.el.find(".ds-dialog").css("width","320px");if(a.find(".ds-icons-32 a").click(c),!l.deny_anonymous){var n=s.el.find("form");n.submit(function(){var e=n.find("input[name=author_email]").val();return!e&&!l.require_guest_email||e.match(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)?(t(C.toJSON(n)),s.close(),!1):(alert("请输入一个有效的email地址."),!1)}),n.find("input[name=author_name]")[0].focus()}};l.deny_anonymous&&q.focus(function(){if(i()){k(_,T);var e=function(t){t.stopPropagation(),q.unbind("click",e)};q.click(e)}return!1});var T=function(e){s(_),I.post("posts/create",B.extend(C.toJSON(_),e),function(e){var t=ce[e.response.post_id]=new Z(e.response),s=N(n.postList,t,l);if("asc"==l.order==("top"==l.formPosition)&&C.scrollTo(s),o.data.comments++,o.updateCounter("duoshuo"),q.val("").trigger("keyup"),a(_),g.hasClass("ds-inline-replybox")&&(g.detach(),n.actionsBar.removeClass("ds-reply-active")),f)try{f.removeItem("ds_draft_"+o.threadId)}catch(i){}},function(e){a(_),alert(e.errorMessage)})};_.submit(function(){if(_.data("submitting"))return!1;var e=B.trim(_[0].message.value);return""==e||!M.placeholder&&e==q.attr("placeholder")?(alert("您还没写内容呢"),!1):(i()?k(_,T):T(),!1)});var S=function(e){return B(e).hasClass("ds-service-icon-grey")?null:B(e).attr("data-service")};if(y.click(function(){return B(this).toggleClass("ds-service-icon-grey").toggleClass("ds-service-icon"),b.value=B.map(y,S).join(","),b.checked=""!=b.value,!1}),B(b).change(function(){var e=this.checked;y[e?"removeClass":"addClass"]("ds-service-icon-grey")[e?"addClass":"removeClass"]("ds-service-icon"),this.value=B.map(y,S).join(",")}),!e&&f){var j="ds_draft_"+o.threadId;q.bind("focus blur keyup",function(e){var t=B(e.currentTarget).val();try{f[j]=t}catch(e){}}),f[j]&&q.val(f[j])}return this}},se.Dialog=W.extend({init:function(e,t){(this.el=B("#ds-wrapper"))[0]||(this.el=p(B('<div id="ds-wrapper"></div>'))),this.options=B.extend({width:600},t),e!==s&&B(e).attr("id","ds-reset").appendTo(this.el)},open:function(){function e(e){return 27==e.which?(a.close(),!1):void 0}function s(){return a.close(),!1}var a=this;return a.el.hide().appendTo(t.body).fadeIn(200),M.ie6&&a.el.css("top",V.scrollTop()+100),a.el.show().find(".ds-dialog").delegate("a.ds-dialog-close","click",function(){return a.close(),!1}).click(n),G.keydown(e),B(t.body).click(s),a.close=function(){G.unbind("keydown",e),B(t.body).unbind("click",s),a.el.fadeOut(200,function(){B(this).remove()}),a.trigger("close")},a}}),ee.likePanel=function(e){return e.likes?'<span class="ds-highlight">'+e.likes+"</span> 人喜欢":""},se.Meta=function(e){this.embedThread=e},se.Meta.prototype={render:function(){function a(a){function i(e){o.set(e),r.resetLikePanel()}function l(){r.tooltip.detach(),B(t.body).unbind("click",l)}function u(t){switch(this.className){case"ds-like-tooltip-close":l(t);break;default:if(!e.open(this.href,"_blank","height=500,width=600,top=0,left=0,toolbar=no,menubar=no,resizable=yes,location=yes,status=no"))return}return!1}var p=c.hasClass("ds-thread-liked");if(I.post("threads/vote",{thread_id:r.embedThread.threadId,vote:p?0:1},i),c.toggleClass("ds-thread-liked"),c.find(".ds-thread-like-text").text(p?"喜欢":"已喜欢"),p)return r.tooltip&&l(a),!1;if(r.tooltip===s){var h=ee.likeTooltip({services:{qzone:"QQ空间",weibo:"新浪微博",qqt:"腾讯微博",renren:"人人网",kaixin:"开心网",douban:"豆瓣网",baidu:"百度搜藏"},thread_id:o.data.thread_id});r.tooltip=B(h).click(n).delegate("a","click",u)}var m={};return m.left=0,m.top=d.position().top+d.outerHeight()-4+"px",r.tooltip.appendTo(r.embedThread.innerEl).css(m),B(t.body).click(l),!1}var r=this,o=r.embedThread.model,d=r.el=B(ee.meta(o.toJSON())),c=d.find(".ds-like-thread-button");
return c.click(a),r.resetLikePanel(),i()&&d.hide(),r},resetLikePanel:function(){this.el.find(".ds-like-panel").html(ee.likePanel(this.embedThread.model.toJSON()))}},se.PostListHead=function(e){this.embedThread=e},se.PostListHead.prototype={render:function(){function e(e){i.find("a.ds-current").removeClass("ds-current"),a.params.page=1;var t=e.currentTarget;switch(t.className){case"ds-comments-tab-duoshuo":a.params.source="duoshuo",s.replybox.el.show();break;case"ds-comments-tab-repost":a.params.source="repost",s.replybox.el.hide();break;case"ds-comments-tab-weibo":a.params.source="weibo",s.replybox.el.hide();break;case"ds-comments-tab-qqt":a.params.source="qqt",s.replybox.el.hide()}return B(t).addClass("ds-current"),a.refetch(),!1}function t(){return r.find("a.ds-current").removeClass("ds-current"),a.params.order=s.options.order=this.className.replace("ds-order-",""),a.params.page=1,a.refetch(),B(this).addClass("ds-current"),!1}var s=this.embedThread,a=s.postList,n=this.el=B(ee.postListHead({thread:s.model.toJSON(),options:s.options})),i=n.find("ul.ds-comments-tabs");i.delegate(".ds-tab a","click",e);var r=n.find(".ds-sort");return r.delegate("a","click",t),r.find(".ds-order-"+a.params.order).addClass("ds-current"),this}},se.Paginator=function(e){function t(){return n.params.page=parseInt(this.innerHTML),n.refetch(),a.find(".ds-current").removeClass("ds-current"),B(this).addClass("ds-current"),!1}e=e||{};var s=this,a=s.el=e.el||B('<div class="ds-paginator"></div>'),n=s.collection=e.collection;a.delegate("a","click",t)},se.Paginator.prototype={reset:function(e){function t(e){n.push('<a data-page="'+e+'" href="javascript:void(0);">'+e+"</a>")}var s,a=this.collection.params.page||1,n=[];if(a>1)for(t(1),s=a>4?a-2:2,s>2&&n.push('<span class="page-break">...</span>');a>s;s++)t(s);if(n.push('<a data-page="'+a+'" href="javascript:void(0);" class="ds-current">'+a+"</a>"),a<e.pages){for(s=a+1;a+4>=s&&s<e.pages;s++)t(s);s<e.pages&&n.push('<span class="page-break">...</span>'),t(e.pages)}this.el.html('<div class="ds-border"></div>'+n.join(" "))[e.pages>1?"show":"hide"]()}},C.addSmilies=function(e,t){var s=C.smiliesTooltip;s&&s.el.find("ul.ds-smilies-tabs").append("<li><a>"+e+"</a></li>"),C.smilies[e]=t},se.SmiliesTooltip=function(){},se.SmiliesTooltip.prototype={render:function(){function e(){var e=s.replybox,a=e.el.find("textarea"),n=a[0],i=n.value;if(t.selection){n.value=i.substring(0,a.data("ds-range-start"))+this.title+i.substring(a.data("ds-range-end"),i.length),n.value=n.value.replace(R.leave_a_message,""),n.focus();var r=t.selection.createRange();r.moveStart("character",a.data("ds-range-start")+this.title.length),r.collapse(),r.select()}else{var o=n.selectionStart+this.title.length;n.value=i.substring(0,n.selectionStart)+this.title+i.substring(n.selectionEnd),n.setSelectionRange(o,o)}e.hideSmilies(),n.focus()}var s=this,a=s.el=B(ee.smiliesTooltip(A));return a.click(n).find("ul.ds-smilies-tabs").delegate("a","click",function(){s.reset(this.innerHTML)}),a.find(".ds-smilies-container").delegate("img","click",e),this},reset:function(e){function t(t,s){var n=0===e.indexOf("微博")?"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/"+s.replace("_org","_thumb"):C.STATIC_URL+"/images/smilies/"+s;"WordPress"===e&&(t=" "+t+" "),a+='<li><img src="'+n+'" title="'+y(t)+'" /></li>'}var s=this.el.find("ul.ds-smilies-tabs");s.find("a.ds-current").removeClass("ds-current"),s.find("a").filter(function(){return this.innerHTML==e}).addClass("ds-current");var a="<ul>";return B.each(A[e],t),a+="</ul>",this.el.find(".ds-smilies-container").html(a),this}},ee.postPlaceholder=function(){return['<li class="ds-post ds-post-placeholder">',R.no_comments_yet,"</li>"].join("")};var $=B('<div id="ds-bubble"><div class="ds-bubble-content"></div><div class="ds-arrow ds-arrow-down ds-arrow-border"></div><div class="ds-arrow ds-arrow-down"></div></div>'),X=$.find(".ds-bubble-content").delegate("a.ds-ctx-open","click",function(){function e(e){function t(e,t){return ee.ctxPost({post:e,index:t})}S.log(B.map(e.response,t).join("\n")),s.el.find("ol"),s.el.find("ol").html(B.map(e.response,t).join("\n"))}var t={};t.post_id=X.attr("data-post-id"),I.get("posts/conversation",t,e);var s=E('<h2>查看对话</h2><ol id="ds-ctx"></ol>');return s.el.find(".ds-dialog").css("width","600px"),s.el.find(".ds-dialog-body").css({"max-height":"350px",_height:"350px","overflow-y":"auto","padding-top":"10px"}),!1}),te=bubbleOutTimer=0;$.mouseenter(O).mouseleave(L),se.PostList=function(e){e&&(e.params&&(this.params=e.params),e.embedThread&&(this.embedThread=e.embedThread)),this.el=B('<ul class="ds-comments"></ul>')},se.PostList.prototype={url:"threads/listPosts",render:function(){return U.call(this.el,this.embedThread,this.embedThread.options),this},reset:function(e){var t=this.embedThread.options;this.el.html(e[0]?B.map(ce.getJSON(e),function(e){return ee.post({post:e,options:t})}).join(""):ee.postPlaceholder())},refetch:function(){function e(e){ce.set(e.parentPosts||e.relatedPosts),le.set(e.users),s.reset(e.response),s.embedThread.paginator.reset(e.cursor),s.el.fadeTo(200,1),C.scrollTo(s.el),a.remove()}var s=this,a=B(ee.indicator()).appendTo(t.body).fadeIn(200);s.el.fadeTo(200,.5),I.get(s.url,s.params,e)}},se.RelatedRead=function(){this._init()},se.RelatedRead.prototype={uri:"base/recommend",mountedAfter:[".detail_main .detail_con .d_img p:last",".jun4_article .jun4_cententttt","#content p:last",".article .content p:last",'.card_box p>[src="http://cpro.baidustatic.com/cpro/ui/cm.js"]:eq(2)'],mountedBefore:[".neirong_main .pagelist"],_init:function(){this.el=B('<div id="ds-related-reads"></div>'),this._count_timer=null},_unpackImages:function(e){for(var t,s=e.image_list.slice(0,3),a=[];s.length;)t=s.shift(),a.push(t.medium_image);return a},_transform:function(e){for(var t=[],s=0,a=e.length;a>s;s++)t.push({url:e[s].url,title:e[s].title,type:e[s].type,source:e[s].source,imgs:this._unpackImages(e[s]),timeStamp:1e3*e[s].publish_time,hasVideo:e[s].has_video,videoDuration:this._parseVideoDuration(e[s].video_duraion)});return t},_parseVideoDuration:function(e){e=+e;var t=Math.floor(e/3600),s=Math.floor((e-60*t*60)/60),e=e-60*t*60-60*s,a=""+(t?(10>t?"0"+t:t)+" : ":"")+(10>s?"0"+s:s)+" : "+(10>e?"0"+e:e);return a},load:function(e){var t=this;I.get(this.uri,{thread_id:e,url:h.href},function(e){0==e.code?t.render(e.response):t.renderError()})},mount:function(e){var t=B(this.mountedAfter.join(","));if(t.length)try{return void this.el.insertAfter(t)}catch(s){}var a=B(this.mountedBefore.join(","));if(a.length)try{return void this.el.insertBefore(a)}catch(s){}e.append(this.el)},renderError:function(){},render:function(e){this.el.html(ee["related-read"](this._transform(e)));try{this.count()}catch(t){}},count:function(){var e=this;!function t(){clearTimeout(e._count_timer),e.el.find(".ds-reads-date").each(function(){var e,t,s,a,n,i,r=B(this).data("date"),o=(new Date).getTime(),d=o-r,c=new Date(r);d>864e5?(e=c.getFullYear(),t=c.getMonth()+1,s=c.getDate(),B(this).html(e+"年"+t+"月"+s+"日")):d>36e5?(a=Math.floor(d/60/60/1e3),B(this).html(a+"小时前")):d>6e4?(n=Math.floor(d/60/1e3),B(this).html(n+"分钟前")):(i=Math.floor(d/1e3),B(this).html(i+"秒前"))}),e._count_timer=setTimeout(t,6e4)}()},stopCount:function(){clearTimeout(this._count_timer)}},se.EmbedThread=Q.extend({uri:"threads/listPosts",params:"thread-id local-thread-id source-thread-id thread-key category channel-key author-key author-id url limit order max-depth form-position container-url"+(v.match(/MSIE 6\.0/)?"":" title image thumbnail"),render:function(){var e=this.el;if("请将此处替换成文章在你的站点中的ID"===e.data("thread-key"))return alert("请设置正确的 data-thread-key 属性"),!1;e.attr("id","ds-thread").append(ee.waitingImg());var t=e.width(),s=e.data("url")||!e.attr("data-thread-id")&&B("link[rel=canonical]").attr("href");s?e.data("url",q(s)):e.data("container-url",h.href),t&&400>=t&&e.addClass("ds-narrow").data("max-depth",1)},updateCounter:function(e){function t(e){return e.substr(e.indexOf("}")+1)}var s={duoshuo:["comments",t(R.comments_multiple)||"评论"],repost:["reposts",t(R.reposts_multiple)||"转载"],weibo:["weibo_reposts",t(R.weibo_reposts_multiple)||"新浪微博"],qqt:["qqt_reposts",t(R.qqt_reposts_multiple)||"腾讯微博"]};for(var a in s)if(!e||e==a){var n=this.data[s[a][0]];this.el.find(".ds-comments-tab-"+a).html(this.el.hasClass("ds-narrow")?'<span class="ds-service-icon ds-'+a+'"></span>'+n:(n?'<span class="ds-highlight">'+n+"</span>":"0")+s[a][1])}},onError:function(e){this.el.html("评论框出错啦("+e.code+"): "+e.errorMessage)},onload:function(t){var a=this,n=a.threadId=t.thread.thread_id,r=t.cursor,o=a.options=t.options,d=a.innerEl=p(B('<div id="ds-reset"></div>').appendTo(a.el));a.model=new F(a.data=t.thread),ce.set(t.parentPosts||t.relatedPosts),le.set(t.users),a.el.find("#ds-waiting").remove(),t.options&&t.options.show_recommend&&(a.relatedRead=new se.RelatedRead,a.relatedRead.load(t.thread.thread_id),a.relatedRead.mount(d)),o.like_thread_enabled&&(a.meta=new se.Meta(a),d.append(a.meta.render().el)),o.hot_posts&&t.hotPosts&&t.hotPosts.length&&(a.hotPosts=new se.HotPosts(B('<div class="ds-rounded"></div>'),{max_depth:1,show_context:o.show_context}),a.hotPosts.thread=a,d.append(a.hotPosts.el),a.hotPosts.onload({list:ce.getJSON(t.hotPosts)})),a.postListHead=new se.PostListHead(a),a.postList=new se.PostList({embedThread:a,params:{source:"duoshuo",thread_id:n,max_depth:o.max_depth,order:o.order,limit:o.limit}}),a.postList.render().reset(t.response),a.paginator=new se.Paginator({collection:a.postList}),a.paginator.reset(r);var l=a.replybox=new se.Replybox(a);l.postList=a.postList.el,i()?a.loginButtons=B(ee.loginButtons()).delegate("a.ds-more-services","click",function(){return a.loginButtons.find(".ds-additional-services").toggle(),!1}).delegate("a.ds-service-link","click",c):a.toolbar=B(ee.toolbar()).delegate(".ds-account-control","mouseenter",function(){B(this).addClass("ds-active")}).delegate(".ds-account-control","mouseleave",function(){B(this).removeClass("ds-active")}).delegate("a.ds-bind-more","click",function(){var e=E(ee["dialog-bind-more"]()).el.find(".ds-dialog").addClass("ds-dialog-bind-more").css("width","300px");return e.find("a.ds-service-link").click(c),!1}).delegate("a.ds-unread-comments-count","click",function(){return k("unread-comments"),!1});var u=['<a name="respond"></a>',a.toolbar||a.loginButtons,l.render().el];"top"==o.formPosition&&B.fn.append.apply(d,u),d.append(a.postListHead.render().el,a.postList.el,a.paginator.el),"bottom"==o.formPosition&&B.fn.append.apply(d,u),d.append(ee.poweredBy(o.poweredby_text)),a.updateCounter(),t.alerts&&B.each(t.alerts,function(e,t){B('<div class="ds-alert">'+t+"</div>").insertBefore(a.toolbar||loginButtons)}),o.message&&l.el.find("textarea").val(o.message).focus(),oe.on("reset",function(){var e=oe.data.comments||0;d.find("a.ds-unread-comments-count").html(e).attr("title",e?"你有"+e+"条新回复":"你没有新回复").css("display",e?"inline":"none")}),o.mzadx_id&&(C.require("mzadxN",function(){}),B('<div id="MZADX_'+o.mzadx_id+'" style="margin:0 auto;"></div>').appendTo(d),__mz_rpq=e.__mz_rpq||[],__mz_rpq.push({l:[o.mzadx_id],r:"1",_srv:"MZADX",_callback:function(){}})),C.thread=a,oe.data!==s&&oe.trigger("reset"),i()||P.send({visit_thread_id:a.threadId})},onMessage:function(e){N(this.postList.el,new Z(e),this.options)}}),se.HotPosts=Q.extend({tmpl:"hotPosts",params:"show-quote",render:function(){return this.el.attr("id","ds-hot-posts"),this},onload:function(e){e.options=B.extend(this.options,e.options),Q.prototype.onload.call(this,e),U.call(this.el.find("ul"),this.thread,this.options)}}),se.RecentComments=Q.extend({tmpl:"commentList",uri:"sites/listRecentPosts",params:"show-avatars show-time show-title avatar-size show-admin excerpt-length num-items channel-key",render:function(){this.el.attr("id","ds-recent-comments")},prepare:function(e){return{list:B.map(e.response,function(e){return new Z(e).toJSON()})}}}),se.RecentVisitors=Q.extend({tmpl:"recentVisitors",uri:"sites/listVisitors",params:"show-time avatar-size num-items channel-key",render:function(){this.el.children().detach(),this.el.attr("id","ds-recent-visitors").append(this.waitingEl=B(ee.waitingImg()))}}),se.TopThreads=Q.extend({tmpl:"topThreads",uri:"sites/listTopThreads",params:"range num-items channel-key",render:function(){this.el.children().detach(),this.el.attr("id","ds-top-threads").append(this.waitingEl=B(ee.waitingImg()))}}),se.LoginWidget=Q.extend({tmpl:"loginWidget",render:function(){var e=this.el;e.attr("id","ds-login").html(ee.loginWidget(["weixin","weibo","qq","renren","kaixin","douban"])),e.find("a").click(c),e.find("a.ds-logout").attr("href",Y.logoutUrl())}}),se.ThreadCount=Q.extend({onload:function(e){var t=this.el,s=t.data("count-type")||"comments",a=e.data[s];t[t.data("replace")?"replaceWith":"html"](R[s+"_"+(a?a>1?"multiple":"one":"zero")].replace("{num}",a))}}),se.ShareWidget=Q.extend({tmpl:"shareWidget",render:function(){var e={copyright:"多说分享插件",services:["weibo","qzone","sohu","renren","netease","qqt","kaixin","douban","qq","meilishuo","mogujie","baidu","taobao","google","wechat","diandian","huaban","duitang","youdao","pengyou","facebook","twitter","linkedin","msn"]};this.el.attr("id","ds-share"),this.el.children().attr("id","ds-reset"),this.el.find(".ds-share-aside-inner").html(ee.shareWidget(e)),this.el.find(".ds-share-icons-more").html(ee.shareWidget(e)),this.el.find(".ds-share-icons-more").hide(),this.el.hasClass("flat")&&this.el.find("a").each(function(){B(this).addClass("flat")}),p(this.el),this.delegateEvents()},delegateEvents:function(){var s=this,n=s.el;if(n.children().hasClass("ds-share-inline")){var i=".ds-share-icons-more",r=n.find(i),d="[data-toggle=ds-share-icons-more]";n.delegate(d,"mouseover",function(){r.show()}),n.delegate(d,"mouseout",function(){r.hide()}),n.delegate(i,"mouseover",function(){r.show()}),n.delegate(i,"mouseout",function(){r.hide()})}else{var c=n.children().hasClass("ds-share-aside-left")?"slide-to-right":"slide-to-left",l=n.children();if(!o.cssProperty("transition")){var u=n.children().hasClass("ds-share-aside-left")?"left":"right";n.delegate(".ds-share-aside-toggle","mouseover",function(){var e={},s=M.ie6&&"right"===u;s?e.left=(t.documentElement.scrollLeft+t.documentElement.clientWidth-this.offsetWidth-(parseInt(this.currentStyle.marginLeft,10)||0)-parseInt(this.currentStyle.marginRight,10)||0)-195:e[u]=0,l.animate(e,200)}),n.delegate(".ds-share-aside-inner","mouseleave",function(){var e={},s=M.ie6&&"right"===u;s?e.left=(t.documentElement.scrollLeft+t.documentElement.clientWidth-this.offsetWidth-(parseInt(this.currentStyle.marginLeft,10)||0)-parseInt(this.currentStyle.marginRight,10)||0)+230:e[u]=-229,l.animate(e,200)})}n.delegate(".ds-share-aside-toggle,.ds-share-aside-inner","mouseover",function(){l.addClass(c)}),n.delegate(".ds-share-aside-toggle,.ds-share-aside-inner","mouseleave",function(){l.removeClass(c)})}n.delegate("a","click",function(t){var s=B(this).data("service");if(!n.data("url"))return void alert("请设置data-url");if("wechat"===s){var i=a()+"/api/qrcode/getImage.png",r="?size=240&text="+n.data("url"),d=E(ee["dialog-qrcode"]({qrcode_url:i+r,url:n.data("url")}));d.el.find(".ds-dialog").css("width","320px")}else{var c=a()+"/share-proxy/?"+o.param({service:B(this).data("service"),thread_key:n.data("threadKey"),title:n.data("title"),images:n.data("images"),content:n.data("content"),url:n.data("url")});B(this).data("service")&&e.open(c,"_blank")}t.preventDefault(),t.stopPropagation()})}});var ne=0;C.initSelector=function(e,t){function s(e){H(e),o.extend(R,e.options),de.set(e.response)}var a=[];!T()||!B.isReady&&j||B(e).each(function(e,s){var n=B(s);if(!n.data("initialized")){n.data("initialized",!0);var i=new se[t.type](n,t);if(ae.push(i),"ThreadCount"===t.type){var r=n.attr("data-thread-key");n.attr("data-channel-key")&&(r=n.attr("data-channel-key")+":"+r),a.push(r),de[r]||(de[r]=new F({})),de[r].on("reset",function(){i.onload(this)})}else if(i.uri){var o={};B.each(i.params.split(" "),function(e,t){o[t.replace(/-/g,"_")]=n.attr("data-"+t)||n.data(t)}),I.get(i.uri,J(o),function(e){i.load(e)})}}}),a.length&&I.get("threads/counts",J({threads:a.join(",")}),s)},(C.initView=function(){B.each(z,C.initSelector)})(),B(function(){if(!l){if(!T())return S.error("缺少 duoshuoQuery 的定义");S.warn("请在加载多说 embed.js 之前定义 duoshuoQuery")}setInterval(function(){B(".ds-time").each(function(){var e=B(this).attr("datetime");e&&(this.innerHTML=C.elapsedTime(e))})},2e4),l.ondomready&&l.ondomready(),C.initView(),!ne&&l.short_name&&I.get("analytics/ping",J({}),H)})})}}(window,document)},function(e,t,s){function a(){if(_cqupt_inner_user.xh){_cqupt_inner_user.xb=_cqupt_inner_user.xb.trim(),_cqupt_inner_user.bj=_cqupt_inner_user.bj.trim()+"班",_cqupt_inner_user.nj=_cqupt_inner_user.nj.trim()+"级",_cqupt_inner_user.zym=_cqupt_inner_user.zym.trim()+"专业",document.querySelector("._cqupt-nav-info").classList.add("_cqupt-show"),document.querySelector("._cqupt-nav-user-name").innerHTML=_cqupt_inner_user.xm;var e=["xm","xb","xh","yxm","zym","nj","bj"];e.forEach(function(e){document.querySelector("._cqupt-nav-user-"+e).innerHTML=_cqupt_inner_user[e].trim()}),document.querySelector("._cqupt-nav-user-kb-btn").setAttribute("href","https://jwzx.cqupt.congm.in/jwzxtmp/showKebiao.php?type=student&id="+_cqupt_inner_user.xh);var t=document.createElement("img");t.src="https://jwzx.cqupt.congm.in/showstuPic.php?xh="+_cqupt_inner_user.xh,t.onload=function(){t.complete&&document.querySelector("._cqupt-nav-user-pic").appendChild(t)};var s=document.createElement("img");s.src="https://congm.in/proxy/172.22.80.212.cqupt.congm.in/PHOTO0906CET/"+_cqupt_inner_user.xh+".JPG",s.onload=function(){s.complete&&document.querySelector("._cqupt-nav-user-pic").appendChild(s)}}}!function(){var e=function(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var s in arguments[t])arguments[t].hasOwnProperty(s)&&(e[s]=arguments[t][s]);return e},t=s(3).CrossStorageClient,n=new t("https://cqupt.congm.in/common/storage-iframe.html");n.onConnect().then(function(){return n.get("cqupt_inner")}).then(function(t){function s(e){var t=document.querySelector(e.form);t&&t.querySelector(e.btn).addEventListener("click",function(){var s=t.querySelector(e.input).value;s.trim()&&(i.xh_list||(i.xh_list={}),i.xh_list[s]?i.xh_list[s]+=1:i.xh_list[s]=1,n.set("cqupt_inner",JSON.stringify(i)))})}var i={};t||n.set("cqupt_inner",JSON.stringify({}));try{i=JSON.parse(t)}catch(r){n.set("cqupt_inner",JSON.stringify({})),i={}}var o=0,d=3;if(i.xh_list){var c=i.xh_list;for(var l in c)c.hasOwnProperty(l)&&c[l]>=d&&(o=parseInt(l),d=c[l])}if(o)if(i.xh&&i.xh==o)window._cqupt_inner_user=i,a();else{var u=new XMLHttpRequest;u.open("GET","https://blues.congm.in/stu.php?searchKey="+parseInt(o),!0),u.onload=function(){if(u.status>=200&&u.status<400){var t=JSON.parse(u.responseText);1===t.total&&(window._cqupt_inner_user=e({},i,t.rows[0]),n.set("cqupt_inner",JSON.stringify(_cqupt_inner_user)),a())}else window._cqupt_inner_user={}},u.onerror=function(){window._cqupt_inner_user={}},u.send()}"jwzx.cqupt.congm.in"==location.hostname&&s({form:'form[action="login.php"]',btn:'input[src="syspic/go.gif"]',input:'input[name="id"]'}),location.hostname.indexOf("xk")!=-1&&s({form:"form#loginForm",btn:"button#submitButton",input:'input[name="id"]'})})}(),function(){var e=document.querySelector("#_cqupt-title"),t=document.querySelector("[data-target='#_cqupt-duosuo']"),a=document.querySelector("#_cqupt-duosuo"),n=document.querySelector("#_cqupt-side-box"),i=document.querySelectorAll("[data-toggle='sideTab']"),r=i.length,o=document.querySelectorAll("._cqupt-content-item"),d=o.length;n.addEventListener("click",function(e){if(e.target){var t="sideTab"==e.target.getAttribute("data-toggle")?e.target:e.target.parentNode;if("sideTab"==t.getAttribute("data-toggle")){for(var s=0;s<r;s++)i[s].classList.remove("_cqupt-active");for(var a=0;a<d;a++)o[a].classList.add("_cqupt-hidden");var c=t.getAttribute("data-target");"close"!=c?(t.classList.add("_cqupt-active"),n.classList.add("_cqupt-active"),document.querySelector(c).classList.remove("_cqupt-hidden")):n.classList.remove("_cqupt-active")}}}),e.onclick=function(){document.body.classList.remove("_cqupt-body"),n.classList.remove("_cqupt-active"),n.classList.add("_cqupt-close")},t.addEventListener("click",function(){var e=document.createElement("div");e.setAttribute("data-thread-key","1"),e.setAttribute("data-title","内网外入"),e.setAttribute("data-url","https://cqupt.congm.in"),DUOSHUO.EmbedThread(e);var t=a.querySelector("._cqupt-content-bd");t.replaceChild(e,t.lastElementChild)}),document.querySelector("._cqupt-nav-user-info-btn").addEventListener("click",function(){document.querySelector("._cqupt-nav-user-info").classList.remove("_cqupt-hidden"),document.querySelector("._cqupt-nav-user-pic").classList.add("_cqupt-hidden")}),document.querySelector("._cqupt-nav-user-pic-btn").addEventListener("click",function(){document.querySelector("._cqupt-nav-user-info").classList.add("_cqupt-hidden"),document.querySelector("._cqupt-nav-user-pic").classList.remove("_cqupt-hidden")}),function(e){for(var t="<tbody>",s=0;s<e.length;s++)t+="<tr>",t+="<td>"+e[s].user_id+"</td>",t+="<td>"+e[s].user_name+"</td>",t+="<td>"+e[s].time+"</td>",t+="<td>"+e[s].money+"</td>",t+="</tr>";t+="</tbody>",document.querySelector("._cqupt-donate-list").insertAdjacentHTML("afterbegin",t)}(s(5))}()},,,function(e,t){e.exports={tagsList:[{href:"https://jwzx.cqupt.congm.in",title:"教务在线"},{href:"https://jwzx.cqupt.congm.in",title:"教务在线"},{href:"http://bbs.cqupt.edu.cn.cqupt.congm.in/bbs/forum.php",title:"幽幽黄桷兰"},{href:"http://oa.cqupt.edu.cn.cqupt.congm.in",title:"校务信息网"},{href:"http://222.177.140.105.cqupt.congm.in",title:"网上党校"},{href:"http://xk1.cqupt.edu.cn.cqupt.congm.in",title:"选课地址1"},{href:"http://xk2.cqupt.edu.cn.cqupt.congm.in/",title:"选课地址2"},{href:"http://xk4.cqupt.edu.cn.cqupt.congm.in",title:"选课地址4"},{href:"http://xk2.cqupt.edu.cn.cqupt.congm.in/xpj2016/",title:"学评教"},{href:"http://oj.cqupt.edu.cn.cqupt.congm.in",title:"ACM/OJ"},{href:"http://bxf.cqupt.edu.cn.cqupt.congm.in/Bscore/",title:"B学分"}]}},,function(e,t){},,,function(e,t,s){function a(){function e(){d.offsetWidth<=c.offsetWidth&&(t=d.scrollLeft,d.scrollLeft+=l,t==d.scrollLeft&&(l=-l),s=setTimeout(e,20))}if(r++,!(r>15))if(window._cqupt_inner_user){clearTimeout(h);var t,s,i=n("#warn"),o=n("#warn-text"),d=i.get(0),c=o.get(0),l=1,u={up:function(){i.animate({top:"-48px"},"slow"),clearTimeout(s)},down:function(t){var s={showTime:500,moveTime:4e3,totalTime:15e3};n.each(t,function(t,a){setTimeout(function(){d.scrollLeft=0,o.html(a),i.animate({top:"18px"},"slow")},s.totalTime*t+s.showTime),setTimeout(function(){e()},s.totalTime*t+s.moveTime),setTimeout(function(){u.up()},s.totalTime*t+s.totalTime)})}},p=[_cqupt_inner_user.xm+"同学，您好。欢迎使用内网外入！"];u.down(p)}else var h=setTimeout(a,1e3)}s(13);var n=s(9);s(10),s(7);var i=s(4);document.body.insertAdjacentHTML("beforeend",i),s(8),n(function(){var e=n(".main_input"),t=n("#enter"),a=n("#more"),i=n(".tagcloud"),r=n("#status"),o=a.find("p"),d=function(){var e=0,t=200,s=function(){e=0},a=function(s){setTimeout(function(){n(s).addClass("up")},e),e+=t},i=function(e){n(e).removeClass("up")},r=function(s){setTimeout(function(){n(s).toggleClass("up")},e),e+=t};return{clean:s,up:a,down:i,toggle:r}}();n(".iUp").each(function(e,t){d.up(t)});var c={reset:function(){r.find("i").attr("class","reset"),r.find("span").text("正在查询中")},on:function(){r.find("i").attr("class","on"),r.find("span").text("服务器在线")},off:function(){r.find("i").attr("class","off"),r.find("span").text("服务器超时")}},l=function(){c.reset();var e=n.ajax({url:"//host.congm.in/status.json?"+(new Date).getTime(),dataType:"json",timeout:1e4,success:function(e){"ok"==e.status?c.on():c.off()},complete:function(t){200!=t.status&&(e.abort(),c.off())}})};l(),r.on("click",l),e.on({focus:function(){this.value==this.defaultValue&&(this.value=""),a.hide(),t.addClass("active")},blur:function(){""==this.value&&(this.value=this.defaultValue),a.hide(),t.removeClass("active")},keypress:function(e){"13"==e.keyCode&&t.click()}});var u=function(e){var t,s,a,n,i=/^((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)(\.((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)){3}$|^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,6}$/,r=!1,d=!0,c=function(e,t){return!!e.test(t)},l=function(e){var t,a;return a=e.indexOf("cqupt.congm.in")==-1?".cqupt.congm.in":"","jwzx.cqupt.edu.cn"==e?(r=!0,t="https://jwzx.cqupt.congm.in"):e.indexOf(":")==-1?(r=c(i,e),t="http://"+e+a):(d=!1,s=e.split(":"),r=c(i,s[0]),t="http://"+s[0]+a),t};n=e.split("/"),t=n[0],a=l(t);for(var u=1;u<n.length;u++)n[u]&&(a+="/"+n[u]);return n[n.length-1].indexOf(".")==-1&&(a+="/"),r?d?o.html('外网地址为：<a target="_blank" href="'+a+'">'+a+'</a><br><small>(若无法访问请检查地址或<a href="http://congm.in">联系作者Cong Min</a>)</small>'):o.html('外网地址为：<a target="_blank" href="'+a+'">'+a+"</a><br><small>温馨提醒: 内网外入只支持访问默认80端口网站!</small>"):(o.html("输入的内网地址，格式有误！<br>请检查后重新输入。"),a=0),a};t.on("click",function(){a.show();var t=n.trim(e.val());t.indexOf("http://")!=-1&&(t=t.split("http://")[1],e.val(t)),t.indexOf("https://")!=-1&&(t=t.split("https://")[1],e.val(t));var s=u(t);s&&window.open(s)});var p=n(".bdsharebuttonbox");n("#share").on("mouseover",function(){p.fadeIn()}),n(".shareBox").on("mouseleave",function(){p.fadeOut()}),function(e){var t=e.tagsList;n.each(t,function(e,t){i.append("<a target='_blank' href='"+t.href+"'>"+t.title+"</a>")}),tagcloud({radius:100,fontsize:17})}(s(11))});var r=0;a()}]);